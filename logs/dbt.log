[0m16:27:27.866257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503DBC25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250409C2BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250409C33D0>]}


============================== 16:27:27.870264 | 55b6e2f2-eac9-47ed-9778-6dd4df4df07e ==============================
[0m16:27:27.870264 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:27:27.871263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Justinas\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:27:27.872262 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path E:\Documents\DE course\M3_S2\jukaral-DE3.2.5\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:27:27.873264 [debug] [MainThread]: Command `dbt run` failed at 16:27:27.873264 after 0.02 seconds
[0m16:27:27.874264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002503DBC25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025039B73340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250409C3460>]}
[0m16:27:27.874264 [debug] [MainThread]: Flushing usage events
[0m16:28:23.298020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7583B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E786A2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E786A0610>]}


============================== 16:28:23.302525 | d80f01d9-b881-46eb-a637-7a2f8c9025b1 ==============================
[0m16:28:23.302525 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:28:23.302525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:23.305037 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  E:\Documents\DE course\M3_S2\jukaral-DE3.2.5/profiles.yml
  
[0m16:28:23.307039 [debug] [MainThread]: Command `dbt run` failed at 16:28:23.307039 after 0.06 seconds
[0m16:28:23.308036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7583B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E786A0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E786A0610>]}
[0m16:28:23.308036 [debug] [MainThread]: Flushing usage events
[0m16:32:04.532540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6E54B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D713B5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D713B72E0>]}


============================== 16:32:04.536541 | 14bb26f1-5c7b-41ec-9909-412283895355 ==============================
[0m16:32:04.536541 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:32:04.537540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:32:05.101896 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:32:05.102903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D71EBD090>]}
[0m16:32:05.238257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6EB9AFE0>]}
[0m16:32:05.340535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7208D600>]}
[0m16:32:05.342548 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:32:05.358597 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:32:05.360598 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:32:05.361810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D71FD5480>]}
[0m16:32:07.145281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D723B05B0>]}
[0m16:32:07.162722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D72356680>]}
[0m16:32:07.163724 [info ] [MainThread]: Found 1 seed, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:32:07.164722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14bb26f1-5c7b-41ec-9909-412283895355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D72356500>]}
[0m16:32:07.165724 [info ] [MainThread]: 
[0m16:32:07.166722 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:32:07.167722 [debug] [MainThread]: Command end result
[0m16:32:07.239363 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:07.239363 after 2.78 seconds
[0m16:32:07.240870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D6E54B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D719A9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D72356380>]}
[0m16:32:07.240870 [debug] [MainThread]: Flushing usage events
[0m16:35:12.442329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021468EFB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146BD618A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146BD632E0>]}


============================== 16:35:12.446414 | c716c8b7-7283-433d-9811-e18c2d1b85f4 ==============================
[0m16:35:12.446414 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:35:12.446414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:13.057907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146954BC10>]}
[0m16:35:13.155369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146C896E90>]}
[0m16:35:13.157374 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:35:13.167760 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:35:13.185323 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:35:13.186323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146C983A90>]}
[0m16:35:14.338904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CD30AC0>]}
[0m16:35:14.347423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CD309A0>]}
[0m16:35:14.348425 [info ] [MainThread]: Found 1 seed, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:35:14.348425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CD30B20>]}
[0m16:35:14.350423 [info ] [MainThread]: 
[0m16:35:14.351422 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:14.353422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:35:14.353422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:15.160792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_turing-job-ad-project, now create_turing-job-ad-project_turing_dbt_sales)
[0m16:35:15.161790 [debug] [ThreadPool]: Creating schema "database: "turing-job-ad-project"
schema: "turing_dbt_sales"
"
[0m16:35:15.171301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:15.172302 [debug] [ThreadPool]: On create_turing-job-ad-project_turing_dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "connection_name": "create_turing-job-ad-project_turing_dbt_sales"} */
create schema if not exists `turing-job-ad-project`.`turing_dbt_sales`
  
[0m16:35:16.518046 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:fe2fcf2b-9a3e-4d75-82a4-21cc155e93bc&page=queryresults
[0m16:35:17.355076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales'
[0m16:35:17.356507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:18.073003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CB936A0>]}
[0m16:35:18.074001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:18.075504 [info ] [MainThread]: 
[0m16:35:18.079516 [debug] [Thread-1 (]: Began running node seed.turing_sales.superstore_final_dataset
[0m16:35:18.080515 [info ] [Thread-1 (]: 1 of 1 START seed file turing_dbt_sales.superstore_final_dataset ............... [RUN]
[0m16:35:18.081514 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.turing_sales.superstore_final_dataset'
[0m16:35:18.081514 [debug] [Thread-1 (]: Began compiling node seed.turing_sales.superstore_final_dataset
[0m16:35:18.082517 [debug] [Thread-1 (]: Timing info for seed.turing_sales.superstore_final_dataset (compile): 16:35:18.082517 => 16:35:18.082517
[0m16:35:18.082517 [debug] [Thread-1 (]: Began executing node seed.turing_sales.superstore_final_dataset
[0m16:35:18.103550 [debug] [Thread-1 (]: Timing info for seed.turing_sales.superstore_final_dataset (execute): 16:35:18.083514 => 16:35:18.103550
[0m16:35:18.116574 [debug] [Thread-1 (]: Compilation Error in seed superstore_final_dataset (seeds\superstore_final_dataset.csv)
  'utf-8' codec can't decode byte 0xa0 in position 2786: invalid start byte
  
  > in macro materialization_seed_default (macros\materializations\seeds\seed.sql)
  > called by seed superstore_final_dataset (seeds\superstore_final_dataset.csv)
[0m16:35:18.117581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c716c8b7-7283-433d-9811-e18c2d1b85f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CD8A470>]}
[0m16:35:18.117581 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file turing_dbt_sales.superstore_final_dataset ....... [[31mERROR[0m in 0.04s]
[0m16:35:18.119581 [debug] [Thread-1 (]: Finished running node seed.turing_sales.superstore_final_dataset
[0m16:35:18.121580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:18.121580 [debug] [MainThread]: Connection 'create_turing-job-ad-project_turing_dbt_sales' was properly closed.
[0m16:35:18.122583 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales' was properly closed.
[0m16:35:18.122583 [debug] [MainThread]: Connection 'seed.turing_sales.superstore_final_dataset' was properly closed.
[0m16:35:18.123579 [info ] [MainThread]: 
[0m16:35:18.123579 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m16:35:18.125085 [debug] [MainThread]: Command end result
[0m16:35:18.135094 [info ] [MainThread]: 
[0m16:35:18.136451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:18.137457 [info ] [MainThread]: 
[0m16:35:18.137457 [error] [MainThread]:   Compilation Error in seed superstore_final_dataset (seeds\superstore_final_dataset.csv)
  'utf-8' codec can't decode byte 0xa0 in position 2786: invalid start byte
  
  > in macro materialization_seed_default (macros\materializations\seeds\seed.sql)
  > called by seed superstore_final_dataset (seeds\superstore_final_dataset.csv)
[0m16:35:18.138457 [info ] [MainThread]: 
[0m16:35:18.138457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:35:18.140457 [debug] [MainThread]: Command `dbt seed` failed at 16:35:18.140457 after 5.76 seconds
[0m16:35:18.140457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021468EFB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146C9F34C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146CD30AF0>]}
[0m16:35:18.141457 [debug] [MainThread]: Flushing usage events
[0m17:52:18.085144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027010FEB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027013E52C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027013E525F0>]}


============================== 17:52:18.089656 | cd697434-5e1e-4bc2-83d4-e61929a5e008 ==============================
[0m17:52:18.089656 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:52:18.090659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:18.709452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd697434-5e1e-4bc2-83d4-e61929a5e008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027011633700>]}
[0m17:52:18.810728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd697434-5e1e-4bc2-83d4-e61929a5e008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270149895D0>]}
[0m17:52:18.812729 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:52:18.821241 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:52:18.915545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:52:18.916545 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\marts\sales\superstore_final_dataset.sql
[0m17:52:19.073871 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation "`turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.turing_sales.superstore_final_dataset (seeds\superstore_final_dataset.csv)
  - model.turing_sales.superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
[0m17:52:19.076386 [debug] [MainThread]: Command `dbt compile` failed at 17:52:19.076386 after 1.05 seconds
[0m17:52:19.076386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027010FEB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027014D349D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270149952A0>]}
[0m17:52:19.077392 [debug] [MainThread]: Flushing usage events
[0m17:53:37.573896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D17F2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D4645210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D4647A30>]}


============================== 17:53:37.578413 | fe130407-07fc-4c28-b326-ca8101ff04b9 ==============================
[0m17:53:37.578413 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:53:37.578413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:38.215163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe130407-07fc-4c28-b326-ca8101ff04b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D2184D30>]}
[0m17:53:38.310407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe130407-07fc-4c28-b326-ca8101ff04b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D51749D0>]}
[0m17:53:38.311408 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:53:38.320927 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:53:38.411117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:38.412142 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\sales\superstore_final_dataset.sql
[0m17:53:38.562859 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation "`turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.turing_sales.superstore_final_dataset (seeds\superstore_final_dataset.csv)
  - model.turing_sales.superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
[0m17:53:38.566859 [debug] [MainThread]: Command `dbt run` failed at 17:53:38.565862 after 1.05 seconds
[0m17:53:38.566859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D17F2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D5553250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D534E350>]}
[0m17:53:38.567362 [debug] [MainThread]: Flushing usage events
[0m17:54:21.586505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B2FB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91E165270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91E1672E0>]}


============================== 17:54:21.589503 | 3770713c-e84a-41e9-bc4e-fd74519386ee ==============================
[0m17:54:21.589503 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:54:21.590503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:54:22.203813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B94AFE0>]}
[0m17:54:22.305671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91EC95600>]}
[0m17:54:22.307668 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:54:22.317182 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:54:22.404891 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:54:22.405895 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://seeds\superstore_final_dataset.csv
[0m17:54:22.416403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F086890>]}
[0m17:54:22.425916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F03C790>]}
[0m17:54:22.425916 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:54:22.426918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F03C9A0>]}
[0m17:54:22.427916 [info ] [MainThread]: 
[0m17:54:22.428917 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:22.430916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:54:22.430916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:23.289216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales'
[0m17:54:23.289216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:23.983505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91ECA1030>]}
[0m17:54:23.984503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:23.985503 [info ] [MainThread]: 
[0m17:54:23.988504 [debug] [Thread-1 (]: Began running node model.turing_sales.superstore_final_dataset
[0m17:54:23.988504 [info ] [Thread-1 (]: 1 of 1 START sql table model turing_dbt_sales.superstore_final_dataset ......... [RUN]
[0m17:54:23.989504 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.superstore_final_dataset'
[0m17:54:23.990503 [debug] [Thread-1 (]: Began compiling node model.turing_sales.superstore_final_dataset
[0m17:54:23.999020 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.superstore_final_dataset"
[0m17:54:24.001020 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (compile): 17:54:23.990503 => 17:54:24.001020
[0m17:54:24.001020 [debug] [Thread-1 (]: Began executing node model.turing_sales.superstore_final_dataset
[0m17:54:24.020068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:25.048853 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.superstore_final_dataset"
[0m17:54:25.049856 [debug] [Thread-1 (]: On model.turing_sales.superstore_final_dataset: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.superstore_final_dataset"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
      
    
    

    OPTIONS()
    as (
      

select * from `turing-job-ad-project.turing_dbt_sales.superstore_final_dataset`;
    );
  
[0m17:54:25.425498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:83504743-ebde-41a4-a833-d6f123536167&page=queryresults
[0m17:54:25.425498 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [15:80]')
[0m17:54:26.529107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:7bbdb0db-27ce-40c7-a295-b1a3bfacf701&page=queryresults
[0m17:54:26.530107 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:7bbdb0db-27ce-40c7-a295-b1a3bfacf701&page=queryresults
[0m17:54:26.531110 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (execute): 17:54:24.001020 => 17:54:26.531110
[0m17:54:26.546131 [debug] [Thread-1 (]: Database Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Syntax error: Expected ")" but got ";" at [15:80]
  compiled Code at target\run\turing_sales\models\marts\sales\superstore_final_dataset.sql
[0m17:54:26.546131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3770713c-e84a-41e9-bc4e-fd74519386ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F084160>]}
[0m17:54:26.547132 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model turing_dbt_sales.superstore_final_dataset  [[31mERROR[0m in 2.56s]
[0m17:54:26.548134 [debug] [Thread-1 (]: Finished running node model.turing_sales.superstore_final_dataset
[0m17:54:26.550132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:26.550132 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:54:26.551134 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales' was properly closed.
[0m17:54:26.551134 [debug] [MainThread]: Connection 'model.turing_sales.superstore_final_dataset' was properly closed.
[0m17:54:26.551134 [info ] [MainThread]: 
[0m17:54:26.552642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m17:54:26.553653 [debug] [MainThread]: Command end result
[0m17:54:26.572678 [info ] [MainThread]: 
[0m17:54:26.573183 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:26.574187 [info ] [MainThread]: 
[0m17:54:26.575191 [error] [MainThread]:   Database Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Syntax error: Expected ")" but got ";" at [15:80]
  compiled Code at target\run\turing_sales\models\marts\sales\superstore_final_dataset.sql
[0m17:54:26.575191 [info ] [MainThread]: 
[0m17:54:26.576191 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:26.577191 [debug] [MainThread]: Command `dbt run` failed at 17:54:26.577191 after 5.05 seconds
[0m17:54:26.578193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B2FB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F10B400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91F10B0A0>]}
[0m17:54:26.578193 [debug] [MainThread]: Flushing usage events
[0m17:56:00.240712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185AE52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185DCA2BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185DCA3A30>]}


============================== 17:56:00.244710 | 8c83c699-6df3-4d92-8802-49fceb9076ba ==============================
[0m17:56:00.244710 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:00.246071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m17:56:00.849004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185B7E4D30>]}
[0m17:56:00.953436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185E7DA680>]}
[0m17:56:00.954940 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:56:00.965448 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:01.058805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:01.058805 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\sales\superstore_final_dataset.sql
[0m17:56:01.207016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185ED000D0>]}
[0m17:56:01.215129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185EB886D0>]}
[0m17:56:01.215129 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:56:01.216596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185EB88850>]}
[0m17:56:01.217595 [info ] [MainThread]: 
[0m17:56:01.219526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:01.220597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales'
[0m17:56:01.221483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:02.145208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c83c699-6df3-4d92-8802-49fceb9076ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185E7E6530>]}
[0m17:56:02.145208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:02.146215 [info ] [MainThread]: 
[0m17:56:02.150216 [debug] [Thread-1 (]: Began running node model.turing_sales.superstore_final_dataset
[0m17:56:02.151214 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.superstore_final_dataset'
[0m17:56:02.151214 [debug] [Thread-1 (]: Began compiling node model.turing_sales.superstore_final_dataset
[0m17:56:02.159561 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.superstore_final_dataset"
[0m17:56:02.160560 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (compile): 17:56:02.151214 => 17:56:02.160560
[0m17:56:02.161562 [debug] [Thread-1 (]: Began executing node model.turing_sales.superstore_final_dataset
[0m17:56:02.161562 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (execute): 17:56:02.161562 => 17:56:02.161562
[0m17:56:02.163563 [debug] [Thread-1 (]: Finished running node model.turing_sales.superstore_final_dataset
[0m17:56:02.163563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:02.165069 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales' was properly closed.
[0m17:56:02.165069 [debug] [MainThread]: Connection 'model.turing_sales.superstore_final_dataset' was properly closed.
[0m17:56:02.166077 [debug] [MainThread]: Command end result
[0m17:56:02.180592 [debug] [MainThread]: Command `dbt compile` succeeded at 17:56:02.180592 after 2.00 seconds
[0m17:56:02.181590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185AE52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185E7DA680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185E7E7730>]}
[0m17:56:02.181590 [debug] [MainThread]: Flushing usage events
[0m17:56:08.743123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84FC4B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E852AC52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E852AC5930>]}


============================== 17:56:08.747635 | df1b7c77-2d77-4859-98fc-5446774a8668 ==============================
[0m17:56:08.747635 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:08.748643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:09.351080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85029B700>]}
[0m17:56:09.450698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8535F7BB0>]}
[0m17:56:09.451748 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:56:09.464273 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:09.551396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:09.551396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:09.556905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8539DA680>]}
[0m17:56:09.569008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8539A02E0>]}
[0m17:56:09.570006 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:56:09.571008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8539A0460>]}
[0m17:56:09.572006 [info ] [MainThread]: 
[0m17:56:09.573007 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:09.575010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:56:09.576007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:10.290453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales'
[0m17:56:10.291453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:11.151036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8536E58A0>]}
[0m17:56:11.152035 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:11.153035 [info ] [MainThread]: 
[0m17:56:11.156035 [debug] [Thread-1 (]: Began running node model.turing_sales.superstore_final_dataset
[0m17:56:11.156539 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales.superstore_final_dataset .......... [RUN]
[0m17:56:11.157546 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.superstore_final_dataset'
[0m17:56:11.158551 [debug] [Thread-1 (]: Began compiling node model.turing_sales.superstore_final_dataset
[0m17:56:11.166060 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.superstore_final_dataset"
[0m17:56:11.167069 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (compile): 17:56:11.158551 => 17:56:11.166060
[0m17:56:11.167069 [debug] [Thread-1 (]: Began executing node model.turing_sales.superstore_final_dataset
[0m17:56:11.192102 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (execute): 17:56:11.168068 => 17:56:11.192102
[0m17:56:11.195101 [debug] [Thread-1 (]: Compilation Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Trying to create view `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`, but it currently exists as a table. Either drop `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
[0m17:56:11.196101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df1b7c77-2d77-4859-98fc-5446774a8668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8539D1240>]}
[0m17:56:11.196101 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model turing_dbt_sales.superstore_final_dataset . [[31mERROR[0m in 0.04s]
[0m17:56:11.198276 [debug] [Thread-1 (]: Finished running node model.turing_sales.superstore_final_dataset
[0m17:56:11.200277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:11.200277 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:56:11.201274 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales' was properly closed.
[0m17:56:11.201274 [debug] [MainThread]: Connection 'model.turing_sales.superstore_final_dataset' was properly closed.
[0m17:56:11.202273 [info ] [MainThread]: 
[0m17:56:11.202273 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m17:56:11.203278 [debug] [MainThread]: Command end result
[0m17:56:11.211787 [info ] [MainThread]: 
[0m17:56:11.212787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:11.213788 [info ] [MainThread]: 
[0m17:56:11.214788 [error] [MainThread]:   Compilation Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Trying to create view `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`, but it currently exists as a table. Either drop `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
[0m17:56:11.216294 [info ] [MainThread]: 
[0m17:56:11.216294 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:56:11.218306 [debug] [MainThread]: Command `dbt run` failed at 17:56:11.218306 after 2.53 seconds
[0m17:56:11.218306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84FC4B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E853A4A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E853987D30>]}
[0m17:56:11.219304 [debug] [MainThread]: Flushing usage events
[0m17:57:31.124757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1F7FB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D226650F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D22667130>]}


============================== 17:57:31.128268 | 39063d5a-c306-44c2-9e6b-6a6a38cfd7a1 ==============================
[0m17:57:31.128268 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:57:31.129273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:31.745118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D231A24D0>]}
[0m17:57:31.845168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23194940>]}
[0m17:57:31.848686 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:57:31.857200 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:57:31.867720 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:57:31.868720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2333FA90>]}
[0m17:57:33.083716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23477880>]}
[0m17:57:33.092872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23686BC0>]}
[0m17:57:33.093933 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:57:33.094822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23686BC0>]}
[0m17:57:33.095823 [info ] [MainThread]: 
[0m17:57:33.097327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:33.099449 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:57:33.099449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:33.889407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_turing-job-ad-project, now create_turing-job-ad-project_turing_dbt_sales_dev)
[0m17:57:33.890402 [debug] [ThreadPool]: Creating schema "database: "turing-job-ad-project"
schema: "turing_dbt_sales_dev"
"
[0m17:57:33.901916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:33.903916 [debug] [ThreadPool]: On create_turing-job-ad-project_turing_dbt_sales_dev: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "connection_name": "create_turing-job-ad-project_turing_dbt_sales_dev"} */
create schema if not exists `turing-job-ad-project`.`turing_dbt_sales_dev`
  
[0m17:57:35.111468 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:c5cb1fb5-7e99-4724-8159-2e4177f8d7ce&page=queryresults
[0m17:57:35.982715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:57:35.983715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:36.720005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2345DC00>]}
[0m17:57:36.721004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:36.721004 [info ] [MainThread]: 
[0m17:57:36.725003 [debug] [Thread-1 (]: Began running node model.turing_sales.superstore_final_dataset
[0m17:57:36.726002 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.superstore_final_dataset ...... [RUN]
[0m17:57:36.727006 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.superstore_final_dataset'
[0m17:57:36.727006 [debug] [Thread-1 (]: Began compiling node model.turing_sales.superstore_final_dataset
[0m17:57:36.737575 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.superstore_final_dataset"
[0m17:57:36.738583 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (compile): 17:57:36.728062 => 17:57:36.738583
[0m17:57:36.739589 [debug] [Thread-1 (]: Began executing node model.turing_sales.superstore_final_dataset
[0m17:57:36.773145 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.superstore_final_dataset"
[0m17:57:36.774146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:36.775146 [debug] [Thread-1 (]: On model.turing_sales.superstore_final_dataset: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.superstore_final_dataset"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`superstore_final_dataset`
  OPTIONS()
  as select * from `turing-job-ad-project.turing_dbt_sales.superstore_final_dataset`;;


[0m17:57:37.533405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:34881ccb-7d06-416c-aa21-337ff113a7ff&page=queryresults
[0m17:57:37.534408 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [6:86]')
[0m17:57:38.175813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:36c0447c-a7d3-47ce-b07a-c858d3580ac0&page=queryresults
[0m17:57:38.175813 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:36c0447c-a7d3-47ce-b07a-c858d3580ac0&page=queryresults
[0m17:57:38.177319 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (execute): 17:57:36.739589 => 17:57:38.177319
[0m17:57:38.184831 [debug] [Thread-1 (]: Database Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Syntax error: Unexpected ";" at [6:86]
  compiled Code at target\run\turing_sales\models\marts\sales\superstore_final_dataset.sql
[0m17:57:38.184831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39063d5a-c306-44c2-9e6b-6a6a38cfd7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D237244F0>]}
[0m17:57:38.185837 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model turing_dbt_sales_dev.superstore_final_dataset  [[31mERROR[0m in 1.46s]
[0m17:57:38.185837 [debug] [Thread-1 (]: Finished running node model.turing_sales.superstore_final_dataset
[0m17:57:38.189353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:38.189353 [debug] [MainThread]: Connection 'create_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:57:38.190351 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:57:38.190351 [debug] [MainThread]: Connection 'model.turing_sales.superstore_final_dataset' was properly closed.
[0m17:57:38.190351 [info ] [MainThread]: 
[0m17:57:38.191354 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m17:57:38.192351 [debug] [MainThread]: Command end result
[0m17:57:38.202867 [info ] [MainThread]: 
[0m17:57:38.203867 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:38.204865 [info ] [MainThread]: 
[0m17:57:38.204865 [error] [MainThread]:   Database Error in model superstore_final_dataset (models\marts\sales\superstore_final_dataset.sql)
  Syntax error: Unexpected ";" at [6:86]
  compiled Code at target\run\turing_sales\models\marts\sales\superstore_final_dataset.sql
[0m17:57:38.205867 [info ] [MainThread]: 
[0m17:57:38.205867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:57:38.208381 [debug] [MainThread]: Command `dbt run` failed at 17:57:38.208381 after 7.15 seconds
[0m17:57:38.209383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1F7FB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23724D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D23724E20>]}
[0m17:57:38.210389 [debug] [MainThread]: Flushing usage events
[0m17:58:10.185245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8760B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8A4752D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8A475930>]}


============================== 17:58:10.190247 | 6caa2bb2-a386-4c72-a851-5114d096f29d ==============================
[0m17:58:10.190247 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:58:10.190247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:10.832491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87C5B700>]}
[0m17:58:10.932500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8AFA7BB0>]}
[0m17:58:10.934507 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:58:10.944020 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:58:11.036674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:11.037674 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\sales\superstore_final_dataset.sql
[0m17:58:11.186235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B4C80D0>]}
[0m17:58:11.194752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B3502E0>]}
[0m17:58:11.195753 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:58:11.196749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B350460>]}
[0m17:58:11.197749 [info ] [MainThread]: 
[0m17:58:11.199749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:58:11.201748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:58:11.202258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:12.163343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:58:12.163343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:12.926484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B350460>]}
[0m17:58:12.927485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:58:12.928486 [info ] [MainThread]: 
[0m17:58:12.933004 [debug] [Thread-1 (]: Began running node model.turing_sales.superstore_final_dataset
[0m17:58:12.933999 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.superstore_final_dataset ...... [RUN]
[0m17:58:12.934999 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.superstore_final_dataset'
[0m17:58:12.934999 [debug] [Thread-1 (]: Began compiling node model.turing_sales.superstore_final_dataset
[0m17:58:12.943518 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.superstore_final_dataset"
[0m17:58:12.945515 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (compile): 17:58:12.936001 => 17:58:12.944516
[0m17:58:12.945515 [debug] [Thread-1 (]: Began executing node model.turing_sales.superstore_final_dataset
[0m17:58:12.983591 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.superstore_final_dataset"
[0m17:58:12.984591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:12.987592 [debug] [Thread-1 (]: On model.turing_sales.superstore_final_dataset: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.superstore_final_dataset"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`superstore_final_dataset`
  OPTIONS()
  as select * from `turing-job-ad-project.turing_dbt_sales.superstore_final_dataset`;


[0m17:58:14.217950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8bafd736-a022-4b5a-8f47-9c95ae8ca3aa&page=queryresults
[0m17:58:14.984434 [debug] [Thread-1 (]: Timing info for model.turing_sales.superstore_final_dataset (execute): 17:58:12.946517 => 17:58:14.984434
[0m17:58:14.985435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6caa2bb2-a386-4c72-a851-5114d096f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B5725F0>]}
[0m17:58:14.986435 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.superstore_final_dataset . [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m17:58:14.987434 [debug] [Thread-1 (]: Finished running node model.turing_sales.superstore_final_dataset
[0m17:58:14.989435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:14.989435 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:58:14.989435 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:58:14.990437 [debug] [MainThread]: Connection 'model.turing_sales.superstore_final_dataset' was properly closed.
[0m17:58:14.990437 [info ] [MainThread]: 
[0m17:58:14.990437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m17:58:14.991943 [debug] [MainThread]: Command end result
[0m17:58:15.002458 [info ] [MainThread]: 
[0m17:58:15.003467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:15.003467 [info ] [MainThread]: 
[0m17:58:15.004468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:15.005467 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:15.005467 after 4.88 seconds
[0m17:58:15.006582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8760B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B14AA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B337C10>]}
[0m17:58:15.006582 [debug] [MainThread]: Flushing usage events
[0m11:33:34.198898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9600EB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C962F56C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C962F56620>]}


============================== 11:33:34.205057 | 4d3883d7-cda0-4480-9931-36698b14b93a ==============================
[0m11:33:34.205057 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:33:34.206059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:34.938922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3883d7-cda0-4480-9931-36698b14b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C962F03F40>]}
[0m11:33:35.022441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3883d7-cda0-4480-9931-36698b14b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9624B0070>]}
[0m11:33:35.024948 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:33:35.038948 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:33:35.679296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m11:33:35.679296 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\orders.sql
[0m11:33:35.680296 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\dim_customers.sql
[0m11:33:35.680296 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\products.sql
[0m11:33:35.680296 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\sales\sources.yml
[0m11:33:35.681296 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\sales.sql
[0m11:33:35.892564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3883d7-cda0-4480-9931-36698b14b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9640E6710>]}
[0m11:33:35.907668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3883d7-cda0-4480-9931-36698b14b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C963E2BCD0>]}
[0m11:33:35.908667 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:33:35.908667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3883d7-cda0-4480-9931-36698b14b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C963E2BD60>]}
[0m11:33:35.909666 [warn ] [MainThread]: The selection criterion 'dim_customers' does not match any nodes
[0m11:33:35.910666 [info ] [MainThread]: 
[0m11:33:35.910666 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:33:35.911666 [debug] [MainThread]: Command end result
[0m11:33:35.920667 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:35.919666 after 1.78 seconds
[0m11:33:35.920667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9600EB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9624B0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C963E2BDF0>]}
[0m11:33:35.920667 [debug] [MainThread]: Flushing usage events
[0m11:34:05.004611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E57EB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E86577C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E8654CA0>]}


============================== 11:34:05.007611 | 349f067f-29c4-443e-9578-19eb99998f5f ==============================
[0m11:34:05.007611 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:34:05.008610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:34:05.518039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E5E3B700>]}
[0m11:34:05.602046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E9188910>]}
[0m11:34:05.603047 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:34:05.611055 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:34:05.690564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:05.691563 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dim_customers.sql
[0m11:34:05.820139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E96C5150>]}
[0m11:34:05.829142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E9541D50>]}
[0m11:34:05.830141 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:34:05.830141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E9541DB0>]}
[0m11:34:05.831142 [info ] [MainThread]: 
[0m11:34:05.832141 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:05.833750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m11:34:05.834759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:06.613682 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m11:34:06.613682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:07.228899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E9540CD0>]}
[0m11:34:07.229898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:34:07.229898 [info ] [MainThread]: 
[0m11:34:07.234898 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_customers
[0m11:34:07.234898 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.dim_customers ................. [RUN]
[0m11:34:07.235897 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_customers'
[0m11:34:07.236899 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_customers
[0m11:34:07.243898 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_customers"
[0m11:34:07.244897 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_customers (compile): 11:34:07.236899 => 11:34:07.243898
[0m11:34:07.244897 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_customers
[0m11:34:07.277900 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_customers"
[0m11:34:07.278898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:34:07.280900 [debug] [Thread-1 (]: On model.turing_sales.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_customers`
  OPTIONS()
  as with customers as {

select
    Customer_ID,
    Customer_Name
from raw.superstore_final_dataset

};


[0m11:34:08.168476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1a16c2d6-1719-42f1-9070-1d2a92ce61e3&page=queryresults
[0m11:34:08.168476 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" but got "{" at [6:24]')
[0m11:34:09.207476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:ff91e665-bdef-493b-8f3a-292297eb939c&page=queryresults
[0m11:34:09.208476 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:ff91e665-bdef-493b-8f3a-292297eb939c&page=queryresults
[0m11:34:09.209476 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_customers (execute): 11:34:07.245902 => 11:34:09.209476
[0m11:34:09.306997 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim_customers.sql)
  Syntax error: Expected "(" but got "{" at [6:24]
  compiled Code at target\run\turing_sales\models\dim_customers.sql
[0m11:34:09.307998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349f067f-29c4-443e-9578-19eb99998f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E96C55D0>]}
[0m11:34:09.307998 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model turing_dbt_sales_dev.dim_customers ........ [[31mERROR[0m in 2.07s]
[0m11:34:09.308997 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_customers
[0m11:34:09.310996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:09.310996 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m11:34:09.310996 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m11:34:09.311995 [debug] [MainThread]: Connection 'model.turing_sales.dim_customers' was properly closed.
[0m11:34:09.311995 [info ] [MainThread]: 
[0m11:34:09.312995 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m11:34:09.313996 [debug] [MainThread]: Command end result
[0m11:34:09.322514 [info ] [MainThread]: 
[0m11:34:09.322514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:34:09.323513 [info ] [MainThread]: 
[0m11:34:09.323513 [error] [MainThread]:   Database Error in model dim_customers (models\dim_customers.sql)
  Syntax error: Expected "(" but got "{" at [6:24]
  compiled Code at target\run\turing_sales\models\dim_customers.sql
[0m11:34:09.324512 [info ] [MainThread]: 
[0m11:34:09.325511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:34:09.326510 [debug] [MainThread]: Command `dbt run` failed at 11:34:09.326510 after 4.37 seconds
[0m11:34:09.326510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E57EB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E9540DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E95419C0>]}
[0m11:34:09.327510 [debug] [MainThread]: Flushing usage events
[0m12:12:26.866660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D547B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D82E6CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D82E4520>]}


============================== 12:12:26.870173 | ea734e8c-07eb-42da-9331-55febd1ba14d ==============================
[0m12:12:26.870173 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:12:26.871170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:27.420159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D5B78850>]}
[0m12:12:27.511118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D8E18910>]}
[0m12:12:27.512117 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:12:27.520627 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:12:27.637925 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
[0m12:12:27.638934 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\src_superstore.yml
[0m12:12:27.638934 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\stg_orders.sql
[0m12:12:27.639933 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\marts\core\dim_customers.sql
[0m12:12:27.639933 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\stg_customers.sql
[0m12:12:27.640942 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\dim_customers.sql
[0m12:12:27.640942 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\marts\sales\superstore_final_dataset.sql
[0m12:12:27.873994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D9473EE0>]}
[0m12:12:27.885023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D91D1F90>]}
[0m12:12:27.886026 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:12:27.887027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D91D1F00>]}
[0m12:12:27.888023 [info ] [MainThread]: 
[0m12:12:27.888529 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:27.890540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:12:27.890540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:28.646323 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:12:28.646323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:29.282097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D91D0E20>]}
[0m12:12:29.283094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:29.283094 [info ] [MainThread]: 
[0m12:12:29.286094 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_customers
[0m12:12:29.287094 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.dim_customers ................. [RUN]
[0m12:12:29.288097 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_customers'
[0m12:12:29.288097 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_customers
[0m12:12:29.297987 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_customers"
[0m12:12:29.298999 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_customers (compile): 12:12:29.289469 => 12:12:29.298999
[0m12:12:29.300001 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_customers
[0m12:12:29.330048 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_customers"
[0m12:12:29.332049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:29.334052 [debug] [Thread-1 (]: On model.turing_sales.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_customers`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

);


[0m12:12:30.030429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:99e25e54-a827-45c1-8c7a-364b13b6068b&page=queryresults
[0m12:12:30.030429 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [10:2]')
[0m12:12:30.914270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:473fd328-2acb-428e-9bb3-07eae4f50dbe&page=queryresults
[0m12:12:30.915284 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:473fd328-2acb-428e-9bb3-07eae4f50dbe&page=queryresults
[0m12:12:30.916282 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_customers (execute): 12:12:29.300001 => 12:12:30.915284
[0m12:12:30.919320 [debug] [Thread-1 (]: Database Error in model dim_customers (models\marts\core\dim_customers.sql)
  Syntax error: Unexpected ";" at [10:2]
  compiled Code at target\run\turing_sales\models\marts\core\dim_customers.sql
[0m12:12:30.920321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea734e8c-07eb-42da-9331-55febd1ba14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D8FF3E50>]}
[0m12:12:30.921321 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model turing_dbt_sales_dev.dim_customers ........ [[31mERROR[0m in 1.63s]
[0m12:12:30.922322 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_customers
[0m12:12:30.924318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:30.924318 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:12:30.924318 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:12:30.925320 [debug] [MainThread]: Connection 'model.turing_sales.dim_customers' was properly closed.
[0m12:12:30.925320 [info ] [MainThread]: 
[0m12:12:30.926322 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m12:12:30.926322 [debug] [MainThread]: Command end result
[0m12:12:30.936440 [info ] [MainThread]: 
[0m12:12:30.936440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:30.937946 [info ] [MainThread]: 
[0m12:12:30.937946 [error] [MainThread]:   Database Error in model dim_customers (models\marts\core\dim_customers.sql)
  Syntax error: Unexpected ";" at [10:2]
  compiled Code at target\run\turing_sales\models\marts\core\dim_customers.sql
[0m12:12:30.938952 [info ] [MainThread]: 
[0m12:12:30.939956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:30.940952 [debug] [MainThread]: Command `dbt run` failed at 12:12:30.940952 after 4.12 seconds
[0m12:12:30.940952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D547B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D91D10F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D91D0D30>]}
[0m12:12:30.941957 [debug] [MainThread]: Flushing usage events
[0m12:13:25.449987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C242B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5296CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5294520>]}


============================== 12:13:25.452987 | a417bbad-f883-4b3d-a396-bcbfd89226a0 ==============================
[0m12:13:25.452987 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:13:25.453988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:13:25.998175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C2B28850>]}
[0m12:13:26.088016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5DC82B0>]}
[0m12:13:26.089024 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:13:26.097603 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:13:26.178489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:26.179496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:26.184497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C61C04F0>]}
[0m12:13:26.194046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C618E0E0>]}
[0m12:13:26.194046 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:13:26.195047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C618E050>]}
[0m12:13:26.196047 [info ] [MainThread]: 
[0m12:13:26.197554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:13:26.199099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:13:26.199099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:26.875988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:13:26.875988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:27.490352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C618CF70>]}
[0m12:13:27.490352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:27.491347 [info ] [MainThread]: 
[0m12:13:27.494346 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customers
[0m12:13:27.495351 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m12:13:27.496349 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m12:13:27.496349 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customers
[0m12:13:27.504397 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m12:13:27.506397 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (compile): 12:13:27.496349 => 12:13:27.506397
[0m12:13:27.506397 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customers
[0m12:13:27.543379 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m12:13:27.545379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:27.547885 [debug] [Thread-1 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select
    Customer_ID,
    Customer_Name
from source

)

select * from customers;


[0m12:13:28.615985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:01a17433-4e4c-4dd3-86ca-d7f4bf29654e&page=queryresults
[0m12:13:29.222039 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (execute): 12:13:27.507904 => 12:13:29.222039
[0m12:13:29.223039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a417bbad-f883-4b3d-a396-bcbfd89226a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5FA05B0>]}
[0m12:13:29.224040 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m12:13:29.225041 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customers
[0m12:13:29.226043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:29.226043 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:13:29.227548 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:13:29.228074 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m12:13:29.228074 [info ] [MainThread]: 
[0m12:13:29.229081 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:13:29.230080 [debug] [MainThread]: Command end result
[0m12:13:29.246126 [info ] [MainThread]: 
[0m12:13:29.247747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:29.248256 [info ] [MainThread]: 
[0m12:13:29.248256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:29.250262 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:29.249263 after 3.85 seconds
[0m12:13:29.250262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C242B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5F6FF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C5DD6F20>]}
[0m12:13:29.251262 [debug] [MainThread]: Flushing usage events
[0m12:18:16.673046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0323B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06055270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D060572E0>]}


============================== 12:18:16.676554 | 18050a80-5f73-44e6-a188-910959dbe928 ==============================
[0m12:18:16.676554 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:18:16.676554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:17.238881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D038D8850>]}
[0m12:18:17.328407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06B89240>]}
[0m12:18:17.329924 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:18:17.339491 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:18:17.419840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:18:17.420836 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\stg_customers.yaml
[0m12:18:17.441949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06FE2980>]}
[0m12:18:17.452845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06F9A800>]}
[0m12:18:17.452845 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:18:17.453706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06F9B7C0>]}
[0m12:18:17.454720 [info ] [MainThread]: 
[0m12:18:17.454720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:17.457234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:18:17.458237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:18.279227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:18:18.280224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:18.929092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06F9BEB0>]}
[0m12:18:18.930095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:18.931094 [info ] [MainThread]: 
[0m12:18:18.934093 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customers
[0m12:18:18.934093 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m12:18:18.935090 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m12:18:18.936091 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customers
[0m12:18:18.943683 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m12:18:18.944683 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (compile): 12:18:18.936091 => 12:18:18.944683
[0m12:18:18.946191 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customers
[0m12:18:18.980156 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m12:18:18.981157 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:18.982156 [debug] [Thread-1 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select
    Customer_ID,
    Customer_Name
from source

)

select * from customers;


[0m12:18:19.920042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:13a67e92-4cbd-4a27-81d9-efededeb088c&page=queryresults
[0m12:18:20.714675 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (execute): 12:18:18.946191 => 12:18:20.714675
[0m12:18:20.716185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18050a80-5f73-44e6-a188-910959dbe928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06F8CDC0>]}
[0m12:18:20.717197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m12:18:20.717197 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customers
[0m12:18:20.719458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:20.719458 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:18:20.720456 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:18:20.720456 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m12:18:20.721457 [info ] [MainThread]: 
[0m12:18:20.721457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m12:18:20.722456 [debug] [MainThread]: Command end result
[0m12:18:20.740115 [info ] [MainThread]: 
[0m12:18:20.741115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:20.741115 [info ] [MainThread]: 
[0m12:18:20.742119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:18:20.744120 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:20.743115 after 4.12 seconds
[0m12:18:20.744120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0323B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06CA27A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06FDFB20>]}
[0m12:18:20.745120 [debug] [MainThread]: Flushing usage events
[0m12:27:34.118169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727854B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727B3B6C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727B3B6620>]}


============================== 12:27:34.122176 | a3fa5ce6-3781-456c-9348-81037967b596 ==============================
[0m12:27:34.122176 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:27:34.122176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:34.646318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017278B9AFE0>]}
[0m12:27:34.732624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727BEE95D0>]}
[0m12:27:34.733623 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:27:34.741216 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:27:34.830991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:34.832001 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customers.sql
[0m12:27:34.964949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C4253F0>]}
[0m12:27:34.974974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C2AE080>]}
[0m12:27:34.975978 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:27:34.975978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C2ADFF0>]}
[0m12:27:34.977972 [info ] [MainThread]: 
[0m12:27:34.977972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:34.980292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:27:34.980292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:35.712278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:27:35.712278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:36.300029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C2ACF10>]}
[0m12:27:36.301027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:36.302028 [info ] [MainThread]: 
[0m12:27:36.304539 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customers
[0m12:27:36.305539 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m12:27:36.306540 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m12:27:36.306540 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customers
[0m12:27:36.314576 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m12:27:36.315578 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (compile): 12:27:36.306540 => 12:27:36.315578
[0m12:27:36.316574 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customers
[0m12:27:36.350284 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m12:27:36.351284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:27:36.352281 [debug] [Thread-1 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name
from source

)

select * from customers;


[0m12:27:37.477252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:a3f46f69-58f0-465f-b3ab-30ec8206ad36&page=queryresults
[0m12:27:38.304608 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customers (execute): 12:27:36.316574 => 12:27:38.303597
[0m12:27:38.304608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa5ce6-3781-456c-9348-81037967b596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C4257E0>]}
[0m12:27:38.305609 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m12:27:38.306604 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customers
[0m12:27:38.308111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:38.309120 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:27:38.309120 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:27:38.309120 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m12:27:38.310118 [info ] [MainThread]: 
[0m12:27:38.310118 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m12:27:38.311117 [debug] [MainThread]: Command end result
[0m12:27:38.320161 [info ] [MainThread]: 
[0m12:27:38.321159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:38.321159 [info ] [MainThread]: 
[0m12:27:38.322160 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:27:38.323668 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:38.323668 after 4.25 seconds
[0m12:27:38.323668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727854B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C050430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C08E410>]}
[0m12:27:38.324678 [debug] [MainThread]: Flushing usage events
[0m12:39:21.830610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0603B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B08EB6BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B08EB41F0>]}


============================== 12:39:21.834621 | 2450e706-fe9a-42cb-8314-4e546ab723b8 ==============================
[0m12:39:21.834621 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:39:21.835617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_customer_addresses', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:22.383515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B08E63F40>]}
[0m12:39:22.472822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B08E632E0>]}
[0m12:39:22.474822 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:39:22.482872 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:39:22.570352 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:39:22.571362 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m12:39:22.572363 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customers.sql
[0m12:39:22.712341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09F35CF0>]}
[0m12:39:22.720591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09DAA6B0>]}
[0m12:39:22.721936 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:39:22.721936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09DAA620>]}
[0m12:39:22.723933 [info ] [MainThread]: 
[0m12:39:22.723933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:22.725934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:39:22.725934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:23.476699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:39:23.478210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:24.162499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09DA9540>]}
[0m12:39:24.163500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:24.164500 [info ] [MainThread]: 
[0m12:39:24.166499 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m12:39:24.168005 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m12:39:24.169012 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m12:39:24.169012 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m12:39:24.176526 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m12:39:24.179044 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 12:39:24.169012 => 12:39:24.179044
[0m12:39:24.179044 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m12:39:24.211644 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m12:39:24.212645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:24.214649 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (

select distinct
    row_number() over (order by Country, City, State, Postal_Code, Region) as address_id,
    Country,
    City,
    State,
    Postal_Code,
    Region
from source

)

select * from customer_addresses;


[0m12:39:25.104418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:2981c77c-63c3-4df3-984d-20f72fe883dd&page=queryresults
[0m12:39:25.718167 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 12:39:24.180550 => 12:39:25.718167
[0m12:39:25.719179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2450e706-fe9a-42cb-8314-4e546ab723b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09F36140>]}
[0m12:39:25.720178 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m12:39:25.720178 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m12:39:25.722460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:25.722460 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:39:25.723459 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:39:25.723459 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m12:39:25.723459 [info ] [MainThread]: 
[0m12:39:25.724459 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m12:39:25.725462 [debug] [MainThread]: Command end result
[0m12:39:25.735001 [info ] [MainThread]: 
[0m12:39:25.736001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:25.737001 [info ] [MainThread]: 
[0m12:39:25.737001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:25.739105 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:25.738001 after 3.96 seconds
[0m12:39:25.739105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0603B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09B8EB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B09DA9F00>]}
[0m12:39:25.739105 [debug] [MainThread]: Flushing usage events
[0m12:41:11.225101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E649BB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E67825420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E67827640>]}


============================== 12:41:11.228605 | 00abbbd9-4318-4e04-b766-c21de3ba2540 ==============================
[0m12:41:11.228605 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:41:11.228605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customer_addresses', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:11.776110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E677D3F40>]}
[0m12:41:11.872873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6835B5B0>]}
[0m12:41:11.873871 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:41:11.881924 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:41:11.966077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:11.966077 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m12:41:12.100668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E68899930>]}
[0m12:41:12.110142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6871A560>]}
[0m12:41:12.111155 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:41:12.111155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6871A4D0>]}
[0m12:41:12.112150 [info ] [MainThread]: 
[0m12:41:12.113148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:41:12.115150 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:41:12.115150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:12.822905 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:41:12.822905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:13.433716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E683FDA20>]}
[0m12:41:13.434715 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:13.435713 [info ] [MainThread]: 
[0m12:41:13.438219 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m12:41:13.438219 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m12:41:13.439750 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m12:41:13.440760 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m12:41:13.448327 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m12:41:13.448327 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 12:41:13.440760 => 12:41:13.448327
[0m12:41:13.449831 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m12:41:13.480045 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m12:41:13.480971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:13.482974 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (

select
    dense_rank() over (order by Country, City, State, Postal_Code, Region) as address_id,
    Country,
    City,
    State,
    Postal_Code,
    Region
from source

)

select * from customer_addresses;


[0m12:41:14.408314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:52fdd887-ec91-498c-a3e7-5f9ca969b7b8&page=queryresults
[0m12:41:14.942956 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 12:41:13.449831 => 12:41:14.942956
[0m12:41:14.943954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00abbbd9-4318-4e04-b766-c21de3ba2540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E68899F30>]}
[0m12:41:14.944955 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m12:41:14.944955 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m12:41:14.946957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:14.946957 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:41:14.946957 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:41:14.948465 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m12:41:14.948465 [info ] [MainThread]: 
[0m12:41:14.948465 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m12:41:14.950003 [debug] [MainThread]: Command end result
[0m12:41:14.958517 [info ] [MainThread]: 
[0m12:41:14.958517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:14.960055 [info ] [MainThread]: 
[0m12:41:14.960055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:41:14.962064 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:14.961062 after 3.79 seconds
[0m12:41:14.962064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E649BB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E684FF9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E684FD690>]}
[0m12:41:14.962064 [debug] [MainThread]: Flushing usage events
[0m12:42:37.496653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018912DDB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018915C452D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018915C45930>]}


============================== 12:42:37.500695 | a0350eb1-23b7-4371-a48f-9bf65305cbb2 ==============================
[0m12:42:37.500695 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:42:37.501693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customer_addresses', 'send_anonymous_usage_stats': 'True'}
[0m12:42:38.039607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189134D8850>]}
[0m12:42:38.127362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916779240>]}
[0m12:42:38.128868 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:42:38.136386 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:42:38.220375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:38.221380 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m12:42:38.354271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916CC9840>]}
[0m12:42:38.362797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916B3E4D0>]}
[0m12:42:38.363798 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:42:38.364799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916B3E440>]}
[0m12:42:38.365797 [info ] [MainThread]: 
[0m12:42:38.365797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:38.366799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:42:38.368304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:39.103588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:42:39.104125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:39.739415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916785660>]}
[0m12:42:39.740425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:39.740425 [info ] [MainThread]: 
[0m12:42:39.743423 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m12:42:39.744423 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m12:42:39.745423 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m12:42:39.746425 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m12:42:39.755990 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m12:42:39.756990 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 12:42:39.746425 => 12:42:39.755990
[0m12:42:39.756990 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m12:42:39.789702 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m12:42:39.789702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:39.791709 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (

select distinct
    Country,
    City,
    State,
    Postal_Code,
    Region
from source

)

select * from customer_addresses;


[0m12:42:40.804689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:843ceb23-a301-4562-acf7-c44df7b47ad3&page=queryresults
[0m12:42:41.364325 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 12:42:39.756990 => 12:42:41.364325
[0m12:42:41.365327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0350eb1-23b7-4371-a48f-9bf65305cbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916CC9F60>]}
[0m12:42:41.366326 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m12:42:41.366326 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m12:42:41.368325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:41.368832 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:42:41.369336 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:42:41.369336 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m12:42:41.369336 [info ] [MainThread]: 
[0m12:42:41.370342 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m12:42:41.371343 [debug] [MainThread]: Command end result
[0m12:42:41.380366 [info ] [MainThread]: 
[0m12:42:41.380366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:41.381369 [info ] [MainThread]: 
[0m12:42:41.381369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:41.383366 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:41.382368 after 3.93 seconds
[0m12:42:41.384369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018912DDB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916B3C100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018916B3DED0>]}
[0m12:42:41.384369 [debug] [MainThread]: Flushing usage events
[0m12:45:31.580495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61B6B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A649D52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A649D5930>]}


============================== 12:45:31.585495 | 2170cb91-7b5e-48ed-94a3-f0b0a708af93 ==============================
[0m12:45:31.585495 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:31.585495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customer_addresses', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:32.135663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A64983F40>]}
[0m12:45:32.223625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6550B5B0>]}
[0m12:45:32.225630 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:45:32.233818 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:32.317738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:32.317738 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m12:45:32.453461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A65A4D930>]}
[0m12:45:32.462509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A658CA560>]}
[0m12:45:32.463510 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:45:32.464507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A658CA4D0>]}
[0m12:45:32.465508 [info ] [MainThread]: 
[0m12:45:32.466508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:32.468020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:45:32.468527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:33.181659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:45:33.182659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:33.802469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A655ADBD0>]}
[0m12:45:33.802469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:33.803469 [info ] [MainThread]: 
[0m12:45:33.806470 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m12:45:33.806470 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m12:45:33.808592 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m12:45:33.809599 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m12:45:33.817598 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m12:45:33.818677 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 12:45:33.809599 => 12:45:33.818677
[0m12:45:33.819686 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m12:45:33.849331 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m12:45:33.850341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:33.851338 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m12:45:34.622187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:91cc6371-7767-4fe5-9c89-dc1b7c88697e&page=queryresults
[0m12:45:35.275656 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 12:45:33.819686 => 12:45:35.275656
[0m12:45:35.276657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2170cb91-7b5e-48ed-94a3-f0b0a708af93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A65A4DE70>]}
[0m12:45:35.277653 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m12:45:35.278664 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m12:45:35.279674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:35.280671 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:45:35.280671 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:45:35.280671 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m12:45:35.281670 [info ] [MainThread]: 
[0m12:45:35.282670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m12:45:35.283675 [debug] [MainThread]: Command end result
[0m12:45:35.291842 [info ] [MainThread]: 
[0m12:45:35.292838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:35.293837 [info ] [MainThread]: 
[0m12:45:35.293837 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:35.295837 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:35.295837 after 3.76 seconds
[0m12:45:35.295837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A61B6B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A658CA080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A658CA0B0>]}
[0m12:45:35.296838 [debug] [MainThread]: Flushing usage events
[0m12:46:32.559493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021225B8B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212289F77C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212289F4CA0>]}


============================== 12:46:32.563493 | 4872f901-8123-4448-ad2c-8a452fc9c734 ==============================
[0m12:46:32.563493 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:46:32.564495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customer_addresses', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:33.111361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212261DAFE0>]}
[0m12:46:33.198734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021228A27670>]}
[0m12:46:33.199742 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:46:33.208252 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:46:33.294128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:33.294128 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m12:46:33.428016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021229A61540>]}
[0m12:46:33.436546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212298EE1D0>]}
[0m12:46:33.436546 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:46:33.438052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212298EE140>]}
[0m12:46:33.438579 [info ] [MainThread]: 
[0m12:46:33.439588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:46:33.441585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m12:46:33.441585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:34.160475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m12:46:34.161474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:34.806628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212298ED060>]}
[0m12:46:34.806628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:34.808132 [info ] [MainThread]: 
[0m12:46:34.811141 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m12:46:34.811141 [info ] [Thread-1 (]: 1 of 1 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m12:46:34.813143 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m12:46:34.813143 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m12:46:34.823484 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m12:46:34.825488 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 12:46:34.814141 => 12:46:34.824481
[0m12:46:34.825488 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m12:46:34.858653 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m12:46:34.859660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:34.861660 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m12:46:35.823268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:639c8e1c-8989-4aac-a72a-95ad519a4a37&page=queryresults
[0m12:46:36.409664 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 12:46:34.826486 => 12:46:36.409664
[0m12:46:36.410668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4872f901-8123-4448-ad2c-8a452fc9c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021229A61C00>]}
[0m12:46:36.411668 [info ] [Thread-1 (]: 1 of 1 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m12:46:36.412665 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m12:46:36.414664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:36.415664 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m12:46:36.415664 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m12:46:36.415664 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m12:46:36.416662 [info ] [MainThread]: 
[0m12:46:36.416662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m12:46:36.416662 [debug] [MainThread]: Command end result
[0m12:46:36.426175 [info ] [MainThread]: 
[0m12:46:36.426175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:36.427176 [info ] [MainThread]: 
[0m12:46:36.428176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:36.429233 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:36.429233 after 3.92 seconds
[0m12:46:36.429233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021225B8B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212297001C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212298ED5A0>]}
[0m12:46:36.430236 [debug] [MainThread]: Flushing usage events
[0m13:21:24.524305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F6B2B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F9995270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F99972E0>]}


============================== 13:21:24.528377 | e7d3e2f4-6d3d-4729-ae9a-85333e364070 ==============================
[0m13:21:24.528377 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:21:24.528377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:25.066787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F7172FE0>]}
[0m13:21:25.153625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F99CB640>]}
[0m13:21:25.154624 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m13:21:25.163668 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:21:25.254710 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 2 files added, 1 files changed.
[0m13:21:25.254710 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m13:21:25.255707 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\staging\superstore\stg_products.sql
[0m13:21:25.255707 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\sales.sql
[0m13:21:25.256710 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\products.sql
[0m13:21:25.256710 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\orders.sql
[0m13:21:25.256710 [debug] [MainThread]: Partial parsing: deleted file: turing_sales://models\marts\core\dim_customers.sql
[0m13:21:25.257710 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_orders.sql
[0m13:21:25.395788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA9FCC10>]}
[0m13:21:25.404300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA8861A0>]}
[0m13:21:25.404300 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:21:25.405300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA885ED0>]}
[0m13:21:25.406305 [info ] [MainThread]: 
[0m13:21:25.407810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:25.409341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m13:21:25.409341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:26.163469 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m13:21:26.164469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:26.793589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA8848E0>]}
[0m13:21:26.794589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:26.794589 [info ] [MainThread]: 
[0m13:21:26.798630 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m13:21:26.798630 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customers
[0m13:21:26.799643 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_orders
[0m13:21:26.800641 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_products
[0m13:21:26.799643 [info ] [Thread-1 (]: 1 of 5 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m13:21:26.800641 [info ] [Thread-2 (]: 2 of 5 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m13:21:26.803638 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m13:21:26.801643 [info ] [Thread-3 (]: 3 of 5 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m13:21:26.803638 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m13:21:26.804641 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m13:21:26.802638 [info ] [Thread-4 (]: 4 of 5 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m13:21:26.805637 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m13:21:26.806642 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customers
[0m13:21:26.814753 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m13:21:26.815750 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_products'
[0m13:21:26.816751 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_orders
[0m13:21:26.820780 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m13:21:26.820780 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_products
[0m13:21:26.824781 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m13:21:26.827777 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m13:21:26.828284 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 13:21:26.806642 => 13:21:26.828284
[0m13:21:26.829292 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customers (compile): 13:21:26.816751 => 13:21:26.828284
[0m13:21:26.829292 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m13:21:26.830293 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customers
[0m13:21:26.853451 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_orders (compile): 13:21:26.821779 => 13:21:26.853451
[0m13:21:26.864526 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m13:21:26.866528 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m13:21:26.866528 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_orders
[0m13:21:26.868034 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (compile): 13:21:26.824781 => 13:21:26.866528
[0m13:21:26.873571 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m13:21:26.873571 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_products
[0m13:21:26.876573 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m13:21:26.876573 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:26.878080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:26.879627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:26.882627 [debug] [Thread-2 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m13:21:26.882627 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m13:21:26.907686 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:26.908701 [debug] [Thread-3 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m13:21:26.961502 [debug] [Thread-4 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m13:21:27.793339 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:bfb08837-7eed-48cf-bd8b-e4a1b131bca6&page=queryresults
[0m13:21:27.826550 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b2e808f6-73b4-4613-8fea-e8f2a060fee3&page=queryresults
[0m13:21:27.858553 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b5d98709-32ea-4224-a518-75e610ee813e&page=queryresults
[0m13:21:27.892540 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:21c4c221-a6b2-4032-9d4e-4867229c0f8c&page=queryresults
[0m13:21:28.358435 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (execute): 13:21:26.874574 => 13:21:28.357919
[0m13:21:28.358435 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FAA8F490>]}
[0m13:21:28.359440 [info ] [Thread-4 (]: 4 of 5 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m13:21:28.360442 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_products
[0m13:21:28.411025 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 13:21:26.830293 => 13:21:28.411025
[0m13:21:28.414027 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customers (execute): 13:21:26.853451 => 13:21:28.414027
[0m13:21:28.415032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA8734C0>]}
[0m13:21:28.416027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FBB278B0>]}
[0m13:21:28.417026 [info ] [Thread-1 (]: 1 of 5 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m13:21:28.418534 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m13:21:28.417026 [info ] [Thread-2 (]: 2 of 5 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m13:21:28.419541 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customers
[0m13:21:28.428577 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_orders (execute): 13:21:26.868565 => 13:21:28.428047
[0m13:21:28.428577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA885ED0>]}
[0m13:21:28.429582 [info ] [Thread-3 (]: 3 of 5 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m13:21:28.430585 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_orders
[0m13:21:28.431583 [debug] [Thread-4 (]: Began running node model.turing_sales.fct_customer_orders
[0m13:21:28.431583 [info ] [Thread-4 (]: 5 of 5 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m13:21:28.432584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_products, now model.turing_sales.fct_customer_orders)
[0m13:21:28.432584 [debug] [Thread-4 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m13:21:28.436585 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m13:21:28.437584 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 13:21:28.433583 => 13:21:28.437584
[0m13:21:28.438095 [debug] [Thread-4 (]: Began executing node model.turing_sales.fct_customer_orders
[0m13:21:28.441610 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m13:21:28.442607 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:28.444608 [debug] [Thread-4 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

final as (
    select
        customers.Customer_ID,
        customers.Customer_Name,
        orders.Order_ID,
        orders.Order_Date,
        orders.Ship_Date,
        orders.Ship_Mode,
        orders.Sale_Ammount

    join customers
    on orders.Customer_ID = customers.Customer_ID
)

select * from final;


[0m13:21:29.088547 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:db79f7dc-834a-405b-9860-227f53cf940c&page=queryresults
[0m13:21:29.089558 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword JOIN at [28:5]')
[0m13:21:29.906357 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:0c8ff060-d24c-468b-bddf-4a472c3a21a8&page=queryresults
[0m13:21:29.906357 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:0c8ff060-d24c-468b-bddf-4a472c3a21a8&page=queryresults
[0m13:21:29.908391 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 13:21:28.438602 => 13:21:29.907864
[0m13:21:29.912397 [debug] [Thread-4 (]: Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Expected ")" but got keyword JOIN at [28:5]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m13:21:29.912397 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d3e2f4-6d3d-4729-ae9a-85333e364070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA9FD5A0>]}
[0m13:21:29.913397 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model turing_dbt_sales_dev.fct_customer_orders .. [[31mERROR[0m in 1.48s]
[0m13:21:29.914400 [debug] [Thread-4 (]: Finished running node model.turing_sales.fct_customer_orders
[0m13:21:29.916400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:29.916400 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m13:21:29.916400 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m13:21:29.916400 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m13:21:29.917907 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m13:21:29.918439 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m13:21:29.918439 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m13:21:29.918439 [info ] [MainThread]: 
[0m13:21:29.919444 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m13:21:29.920445 [debug] [MainThread]: Command end result
[0m13:21:29.942571 [info ] [MainThread]: 
[0m13:21:29.943573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:21:29.943573 [info ] [MainThread]: 
[0m13:21:29.944575 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Expected ")" but got keyword JOIN at [28:5]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m13:21:29.945573 [info ] [MainThread]: 
[0m13:21:29.945573 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:21:29.946569 [debug] [MainThread]: Command `dbt run` failed at 13:21:29.946569 after 5.47 seconds
[0m13:21:29.946569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F6B2B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA8C68C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FA632860>]}
[0m13:21:29.948079 [debug] [MainThread]: Flushing usage events
[0m13:22:02.132173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013493D825C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013496BD5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013496BD7A60>]}


============================== 13:22:02.136170 | ae797acc-10fa-41b3-9501-52e035ec6079 ==============================
[0m13:22:02.136170 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:22:02.137168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:02.666675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134944FBBB0>]}
[0m13:22:02.756499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013496C081F0>]}
[0m13:22:02.758552 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m13:22:02.766560 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:22:02.851579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:22:02.852578 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m13:22:02.989539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497C38BB0>]}
[0m13:22:02.998593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497ABDAE0>]}
[0m13:22:02.998593 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:22:02.999601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497ABD810>]}
[0m13:22:03.001608 [info ] [MainThread]: 
[0m13:22:03.002608 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:03.004608 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m13:22:03.004608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:03.671048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m13:22:03.671048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:04.320492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497820D00>]}
[0m13:22:04.321489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:04.321489 [info ] [MainThread]: 
[0m13:22:04.324489 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_customer_addresses
[0m13:22:04.325490 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customers
[0m13:22:04.325490 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_orders
[0m13:22:04.326489 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_products
[0m13:22:04.326489 [info ] [Thread-1 (]: 1 of 5 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m13:22:04.326489 [info ] [Thread-2 (]: 2 of 5 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m13:22:04.327999 [info ] [Thread-3 (]: 3 of 5 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m13:22:04.329544 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m13:22:04.330540 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m13:22:04.328533 [info ] [Thread-4 (]: 4 of 5 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m13:22:04.331542 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m13:22:04.332541 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m13:22:04.332541 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customers
[0m13:22:04.333542 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_products'
[0m13:22:04.334541 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_orders
[0m13:22:04.342594 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m13:22:04.346595 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m13:22:04.346595 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_products
[0m13:22:04.350109 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m13:22:04.353106 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m13:22:04.354108 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 13:22:04.334541 => 13:22:04.354108
[0m13:22:04.355109 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customers (compile): 13:22:04.342594 => 13:22:04.355109
[0m13:22:04.356108 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m13:22:04.356108 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_orders (compile): 13:22:04.346595 => 13:22:04.356108
[0m13:22:04.357106 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customers
[0m13:22:04.357106 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (compile): 13:22:04.350109 => 13:22:04.357106
[0m13:22:04.387893 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m13:22:04.388420 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_orders
[0m13:22:04.391424 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m13:22:04.392427 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_products
[0m13:22:04.396426 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m13:22:04.400469 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m13:22:04.401468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:04.402469 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:22:04.402469 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:22:04.404468 [debug] [Thread-1 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m13:22:04.405466 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:22:04.431130 [debug] [Thread-3 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m13:22:04.432130 [debug] [Thread-2 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m13:22:04.483370 [debug] [Thread-4 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m13:22:05.346607 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:08b20562-7982-4176-af42-38b666a354ad&page=queryresults
[0m13:22:05.346607 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:7d7f8f68-b5a3-47f9-b685-06faba3a37a6&page=queryresults
[0m13:22:05.369262 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:d2fd81f2-b26f-4063-9598-7aea3e6b0c35&page=queryresults
[0m13:22:05.381326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e37818e4-6447-469e-b5ed-c4c3fc5dad60&page=queryresults
[0m13:22:05.893515 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customers (execute): 13:22:04.388420 => 13:22:05.893515
[0m13:22:05.894516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497AAF160>]}
[0m13:22:05.896512 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (execute): 13:22:04.396426 => 13:22:05.896512
[0m13:22:05.894516 [info ] [Thread-2 (]: 2 of 5 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m13:22:05.898546 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497C39C00>]}
[0m13:22:05.899555 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customers
[0m13:22:05.900554 [info ] [Thread-4 (]: 4 of 5 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m13:22:05.900554 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_products
[0m13:22:05.911593 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_orders (execute): 13:22:04.392427 => 13:22:05.911593
[0m13:22:05.912590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497C39ED0>]}
[0m13:22:05.913593 [info ] [Thread-3 (]: 3 of 5 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m13:22:05.914595 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_orders
[0m13:22:05.914595 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m13:22:05.915596 [info ] [Thread-2 (]: 5 of 5 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m13:22:05.916595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customers, now model.turing_sales.fct_customer_orders)
[0m13:22:05.916595 [debug] [Thread-2 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m13:22:05.921291 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m13:22:05.922289 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 13:22:05.916595 => 13:22:05.922289
[0m13:22:05.922289 [debug] [Thread-2 (]: Began executing node model.turing_sales.fct_customer_orders
[0m13:22:05.926287 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m13:22:05.926287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:05.929333 [debug] [Thread-2 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

final as (
    select
        customers.Customer_ID,
        customers.Customer_Name,
        orders.Order_ID,
        orders.Order_Date,
        orders.Ship_Date,
        orders.Ship_Mode,
        orders.Sale_Ammount
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID
)

select * from final;


[0m13:22:05.957945 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 13:22:04.358109 => 13:22:05.956438
[0m13:22:05.958467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013497D8EC80>]}
[0m13:22:05.959472 [info ] [Thread-1 (]: 1 of 5 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m13:22:05.960476 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m13:22:06.959095 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:98c2ac8e-a9d7-4f60-a84c-18b26cc5f591&page=queryresults
[0m13:22:07.562126 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 13:22:05.923288 => 13:22:07.561126
[0m13:22:07.562126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae797acc-10fa-41b3-9501-52e035ec6079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013498DA3D00>]}
[0m13:22:07.563126 [info ] [Thread-2 (]: 5 of 5 OK created sql view model turing_dbt_sales_dev.fct_customer_orders ...... [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m13:22:07.564125 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m13:22:07.565127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:07.566129 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m13:22:07.566129 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m13:22:07.567130 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m13:22:07.567130 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m13:22:07.567130 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m13:22:07.567130 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m13:22:07.568129 [info ] [MainThread]: 
[0m13:22:07.568640 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m13:22:07.570647 [debug] [MainThread]: Command end result
[0m13:22:07.594687 [info ] [MainThread]: 
[0m13:22:07.595684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:07.596685 [info ] [MainThread]: 
[0m13:22:07.596685 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:22:07.598192 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:07.598192 after 5.52 seconds
[0m13:22:07.599198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013493D825C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134978E2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134978E0610>]}
[0m13:22:07.599198 [debug] [MainThread]: Flushing usage events
[0m16:56:16.689206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ADDD2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B0C26BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B0C27A30>]}


============================== 16:56:16.695729 | 4a8dd006-37b3-4d52-8036-13269fea4d93 ==============================
[0m16:56:16.695729 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:16.695729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:17.426290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AE764D30>]}
[0m16:56:17.515765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1757CD0>]}
[0m16:56:17.516765 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:56:17.532310 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:18.218214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m16:56:18.219213 [debug] [MainThread]: Partial parsing: added file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m16:56:18.219720 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m16:56:18.219720 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m16:56:18.357039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1C9D390>]}
[0m16:56:18.372583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1B11BD0>]}
[0m16:56:18.373586 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:56:18.373586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1B11BA0>]}
[0m16:56:18.376100 [info ] [MainThread]: 
[0m16:56:18.377099 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:56:18.379612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:56:18.379612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:19.181887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:56:19.183203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:20.099434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1B10580>]}
[0m16:56:20.100513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:56:20.101043 [info ] [MainThread]: 
[0m16:56:20.105864 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:56:20.106919 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:56:20.107446 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:56:20.107976 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:56:20.108509 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:56:20.109024 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:56:20.112039 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:56:20.113037 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:56:20.109024 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:56:20.114039 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:56:20.114039 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:56:20.110031 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:56:20.115545 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:56:20.125070 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:56:20.129098 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:56:20.130105 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:56:20.130105 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:56:20.131104 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:56:20.134614 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:56:20.137624 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:56:20.140138 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:56:20.125579 => 16:56:20.139130
[0m16:56:20.140138 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:56:20.141141 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:56:20.115545 => 16:56:20.141141
[0m16:56:20.142143 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:56:20.132108 => 16:56:20.142143
[0m16:56:20.173254 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:56:20.173254 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:56:20.135623 => 16:56:20.173254
[0m16:56:20.174762 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:56:20.174762 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:56:20.175775 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:56:20.179283 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:56:20.183290 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:56:20.186805 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:56:20.187804 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:56:20.190323 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:56:20.190323 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:56:20.191322 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:56:20.217839 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:56:20.217839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:20.245364 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:56:20.273492 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:56:21.165590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:7fa84c40-fe4e-44f7-a487-5f7594f19206&page=queryresults
[0m16:56:21.219934 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:048c06fc-04ca-4fe6-a8f9-ddacdf3f6d29&page=queryresults
[0m16:56:21.237853 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8d19f532-9b99-4b39-bcc6-98a6a5ae2a51&page=queryresults
[0m16:56:21.261140 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:d7470175-64af-458a-ab5d-01b9e45c9377&page=queryresults
[0m16:56:21.753152 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:56:20.175775 => 16:56:21.753152
[0m16:56:21.754658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1B10580>]}
[0m16:56:21.754658 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:56:21.755663 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:56:21.756664 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m16:56:21.757666 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:56:21.757666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m16:56:21.757666 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m16:56:21.761180 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:56:21.762187 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 16:56:21.759173 => 16:56:21.762187
[0m16:56:21.763187 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m16:56:21.766704 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:56:21.767704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:21.769211 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:56:21.800311 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:56:20.180291 => 16:56:21.800311
[0m16:56:21.801318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1C9E7A0>]}
[0m16:56:21.802318 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m16:56:21.803318 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:56:21.848010 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:56:20.183290 => 16:56:21.848010
[0m16:56:21.849524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1C9E8C0>]}
[0m16:56:21.849524 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m16:56:21.850530 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:56:21.853530 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:56:20.142143 => 16:56:21.853530
[0m16:56:21.855034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1B10AC0>]}
[0m16:56:21.856045 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m16:56:21.857041 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:56:21.858040 [debug] [Thread-3 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:56:21.858040 [info ] [Thread-3 (]: 6 of 6 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m16:56:21.859041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customers, now model.turing_sales.fct_customer_orders)
[0m16:56:21.860201 [debug] [Thread-3 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:56:21.865718 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:56:21.866718 [debug] [Thread-3 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:56:21.860201 => 16:56:21.866718
[0m16:56:21.867718 [debug] [Thread-3 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:56:21.876751 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:56:21.877750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:56:21.879255 [debug] [Thread-3 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

)

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final;


[0m16:56:22.618291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1f6b2a8d-299f-466f-8062-8cc0e89089c2&page=queryresults
[0m16:56:22.618291 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "final" at [24:1]')
[0m16:56:22.731367 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:a2fc60f6-8e09-4fa9-b013-c2e525f3b40f&page=queryresults
[0m16:56:23.297647 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 16:56:21.763187 => 16:56:23.297647
[0m16:56:23.299158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B2E30580>]}
[0m16:56:23.299158 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m16:56:23.300168 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m16:56:23.917321 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e1d65ff6-7a5d-4080-8bbc-e518e7826804&page=queryresults
[0m16:56:23.917321 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e1d65ff6-7a5d-4080-8bbc-e518e7826804&page=queryresults
[0m16:56:23.918856 [debug] [Thread-3 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:56:21.867718 => 16:56:23.918856
[0m16:56:24.014810 [debug] [Thread-3 (]: Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Unexpected identifier "final" at [24:1]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m16:56:24.015818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8dd006-37b3-4d52-8036-13269fea4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B2E31630>]}
[0m16:56:24.015818 [error] [Thread-3 (]: 6 of 6 ERROR creating sql view model turing_dbt_sales_dev.fct_customer_orders .. [[31mERROR[0m in 2.16s]
[0m16:56:24.017323 [debug] [Thread-3 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:56:24.019331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:24.019331 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:56:24.019331 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:56:24.020417 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:56:24.020417 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m16:56:24.020417 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:56:24.021418 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m16:56:24.021418 [info ] [MainThread]: 
[0m16:56:24.022419 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m16:56:24.023419 [debug] [MainThread]: Command end result
[0m16:56:24.033451 [info ] [MainThread]: 
[0m16:56:24.033451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:56:24.034960 [info ] [MainThread]: 
[0m16:56:24.035968 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Unexpected identifier "final" at [24:1]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m16:56:24.036969 [info ] [MainThread]: 
[0m16:56:24.036969 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:56:24.038968 [debug] [MainThread]: Command `dbt run` failed at 16:56:24.037971 after 7.41 seconds
[0m16:56:24.038968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ADDD2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1D73970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B1870880>]}
[0m16:56:24.038968 [debug] [MainThread]: Flushing usage events
[0m16:56:44.360357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913A7325C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913D586BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913D587A60>]}


============================== 16:56:44.363357 | 3e2f3914-bd13-4cea-bf63-6749f8eabfd8 ==============================
[0m16:56:44.363357 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:44.363357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:56:44.942331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913AEA96C0>]}
[0m16:56:45.027717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913CAE8790>]}
[0m16:56:45.029229 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:56:45.037763 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:45.121065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:45.122065 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m16:56:45.254631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E5F51B0>]}
[0m16:56:45.263156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E475F00>]}
[0m16:56:45.264662 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:56:45.265669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E475DB0>]}
[0m16:56:45.266672 [info ] [MainThread]: 
[0m16:56:45.267672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:56:45.270186 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:56:45.270186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:45.926658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:56:45.927659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:46.563263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E163E80>]}
[0m16:56:46.564771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:56:46.565779 [info ] [MainThread]: 
[0m16:56:46.569283 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:56:46.569283 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:56:46.570292 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:56:46.571292 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:56:46.570292 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:56:46.572292 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:56:46.572292 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:56:46.573290 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:56:46.574795 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:56:46.573290 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:56:46.574795 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:56:46.575806 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:56:46.575806 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:56:46.576801 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:56:46.577806 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:56:46.587836 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:56:46.591348 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:56:46.592349 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:56:46.594858 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:56:46.597865 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:56:46.600385 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:56:46.577806 => 16:56:46.599450
[0m16:56:46.600385 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:56:46.601388 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:56:46.587836 => 16:56:46.601388
[0m16:56:46.633328 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:56:46.633328 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:56:46.592349 => 16:56:46.633328
[0m16:56:46.633328 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:56:46.595869 => 16:56:46.633328
[0m16:56:46.634834 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:56:46.634834 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:56:46.635845 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:56:46.639346 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:56:46.643355 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:56:46.643355 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:46.648867 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:56:46.649939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:56:46.650941 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:56:46.676518 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:56:46.677516 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:56:46.679026 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:56:46.681035 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:56:46.707607 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:56:47.613339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:6b30bc77-a960-4647-882a-aea452600cf0&page=queryresults
[0m16:56:47.620851 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:ebf4febf-4ba8-426f-9762-5c6719888712&page=queryresults
[0m16:56:47.657728 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:ee6ac26a-9d96-47e0-8b9e-ee7f73f4aba4&page=queryresults
[0m16:56:47.716916 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:a28d7af4-eaa0-4917-92f5-d161382eeb27&page=queryresults
[0m16:56:48.187682 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:56:46.601388 => 16:56:48.187682
[0m16:56:48.187682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E163E80>]}
[0m16:56:48.189251 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m16:56:48.190196 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:56:48.190196 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m16:56:48.191196 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:56:48.192197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m16:56:48.192197 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m16:56:48.195708 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:56:48.196708 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 16:56:48.193195 => 16:56:48.196708
[0m16:56:48.197706 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m16:56:48.202221 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:56:48.203227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:48.204810 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:56:48.236332 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:56:46.644859 => 16:56:48.235325
[0m16:56:48.237332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E6A7160>]}
[0m16:56:48.238334 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m16:56:48.239332 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:56:48.254671 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:56:46.639346 => 16:56:48.254671
[0m16:56:48.255681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E6A71F0>]}
[0m16:56:48.255681 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m16:56:48.256679 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:56:48.294785 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:56:46.635845 => 16:56:48.294785
[0m16:56:48.295793 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E5F6740>]}
[0m16:56:48.296794 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m16:56:48.297794 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:56:48.299300 [debug] [Thread-4 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:56:48.299300 [info ] [Thread-4 (]: 6 of 6 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m16:56:48.301326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_orders, now model.turing_sales.fct_customer_orders)
[0m16:56:48.301326 [debug] [Thread-4 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:56:48.305846 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:56:48.306848 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:56:48.302322 => 16:56:48.306848
[0m16:56:48.306848 [debug] [Thread-4 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:56:48.316882 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:56:48.316882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:56:48.318880 [debug] [Thread-4 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final;


[0m16:56:49.143948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3e4dc0ae-1354-467b-be76-4cb7f3f71527&page=queryresults
[0m16:56:49.449985 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3279ef92-59dd-4d49-b1f8-f98b81cd1807&page=queryresults
[0m16:56:49.755873 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 16:56:48.197706 => 16:56:49.754862
[0m16:56:49.756874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E475A80>]}
[0m16:56:49.757873 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m16:56:49.759381 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m16:56:50.044602 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:56:48.307847 => 16:56:50.043091
[0m16:56:50.044602 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e2f3914-bd13-4cea-bf63-6749f8eabfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E6DBF70>]}
[0m16:56:50.045614 [info ] [Thread-4 (]: 6 of 6 OK created sql view model turing_dbt_sales_dev.fct_customer_orders ...... [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m16:56:50.046609 [debug] [Thread-4 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:56:50.047612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:50.049123 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:56:50.049123 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:56:50.049123 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:56:50.050134 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m16:56:50.050134 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m16:56:50.050134 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:56:50.051135 [info ] [MainThread]: 
[0m16:56:50.051135 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m16:56:50.053134 [debug] [MainThread]: Command end result
[0m16:56:50.063170 [info ] [MainThread]: 
[0m16:56:50.063170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:50.064678 [info ] [MainThread]: 
[0m16:56:50.064678 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:56:50.066687 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:50.066687 after 5.76 seconds
[0m16:56:50.066687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913A7325C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E6F40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913E6DBB50>]}
[0m16:56:50.067688 [debug] [MainThread]: Flushing usage events
[0m16:29:41.568410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970982590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9737D5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9737D7A30>]}


============================== 16:29:41.575429 | d5f59c0a-356e-4543-bf5d-1e0abc7aede6 ==============================
[0m16:29:41.575429 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:29:41.575429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:42.316871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E971314D30>]}
[0m16:29:42.405701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E972D387C0>]}
[0m16:29:42.407705 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:29:42.423759 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:29:43.134991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:29:43.134991 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m16:29:43.267880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9748457E0>]}
[0m16:29:43.278431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9746C2410>]}
[0m16:29:43.278431 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:29:43.279939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9746C23E0>]}
[0m16:29:43.280949 [info ] [MainThread]: 
[0m16:29:43.281946 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:29:43.284021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:29:43.285016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:44.117857 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:29:44.118857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:44.759177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9746C0DF0>]}
[0m16:29:44.759177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:44.760179 [info ] [MainThread]: 
[0m16:29:44.764781 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:29:44.764781 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:29:44.764781 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:29:44.765783 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:29:44.765783 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:29:44.766783 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:29:44.768782 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:29:44.766783 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:29:44.770288 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:29:44.770907 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:29:44.767783 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:29:44.771824 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:29:44.771824 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:29:44.779984 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:29:44.781146 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:29:44.781146 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:29:44.784664 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:29:44.785665 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:29:44.788661 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:29:44.792679 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:29:44.793685 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:29:44.772822 => 16:29:44.793685
[0m16:29:44.794687 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:29:44.782654 => 16:29:44.794687
[0m16:29:44.795687 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:29:44.795687 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:29:44.802812 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:29:44.785665 => 16:29:44.802812
[0m16:29:44.826792 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:29:44.830298 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:29:44.831304 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:29:44.831304 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:29:44.790167 => 16:29:44.831304
[0m16:29:44.835821 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:29:44.836825 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:29:44.837821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:44.837821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:29:44.841335 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:29:44.841335 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:29:44.843851 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    Order_Date as date,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:29:44.844856 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:29:44.896065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:29:44.897063 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:29:44.925718 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:29:45.905877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e7500115-dfa6-4c71-81df-3714753743d4&page=queryresults
[0m16:29:45.906880 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:51a3e749-49df-4410-9a97-6bd889033084&page=queryresults
[0m16:29:45.932983 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:16c2e4ac-857f-49a4-b84f-5363778c1aa7&page=queryresults
[0m16:29:45.935226 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e8ea81a9-de16-486d-abbc-306fdb7baf11&page=queryresults
[0m16:29:46.496494 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:29:44.837821 => 16:29:46.495492
[0m16:29:46.497494 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E974847E50>]}
[0m16:29:46.501004 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:29:44.796688 => 16:29:46.501004
[0m16:29:46.497494 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m16:29:46.502006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9749636A0>]}
[0m16:29:46.503009 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:29:46.503517 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_products
[0m16:29:46.503517 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m16:29:46.505523 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:29:46.504524 [info ] [Thread-4 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:29:46.506525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_orders, now model.turing_sales.stg_products)
[0m16:29:46.507528 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_products
[0m16:29:46.510035 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:29:46.511046 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (compile): 16:29:46.507528 => 16:29:46.511046
[0m16:29:46.511046 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_products
[0m16:29:46.516572 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:29:46.520076 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:29:44.827793 => 16:29:46.520076
[0m16:29:46.521088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E975984490>]}
[0m16:29:46.522085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:29:46.522085 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m16:29:46.523597 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:29:46.525603 [debug] [Thread-4 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:29:46.553695 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:29:44.831304 => 16:29:46.552687
[0m16:29:46.554696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9748ECEB0>]}
[0m16:29:46.555702 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m16:29:46.556702 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:29:46.557705 [debug] [Thread-1 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:29:46.557705 [info ] [Thread-1 (]: 6 of 6 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m16:29:46.558701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.fct_customer_orders)
[0m16:29:46.558701 [debug] [Thread-1 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:29:46.563738 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:29:46.564741 [debug] [Thread-1 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:29:46.560209 => 16:29:46.564741
[0m16:29:46.565737 [debug] [Thread-1 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:29:46.574833 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:29:46.575835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:46.576834 [debug] [Thread-1 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final;


[0m16:29:47.478753 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:36bef539-cfe8-4390-be1b-7514a7d188ea&page=queryresults
[0m16:29:47.638771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:499bb45e-e065-49da-b5c6-37e61c0cd026&page=queryresults
[0m16:29:48.033815 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (execute): 16:29:46.512044 => 16:29:48.033815
[0m16:29:48.034816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9759C2980>]}
[0m16:29:48.035815 [info ] [Thread-4 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m16:29:48.035815 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_products
[0m16:29:48.198745 [debug] [Thread-1 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:29:46.565737 => 16:29:48.198745
[0m16:29:48.200255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f59c0a-356e-4543-bf5d-1e0abc7aede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9759D9BD0>]}
[0m16:29:48.201267 [info ] [Thread-1 (]: 6 of 6 OK created sql view model turing_dbt_sales_dev.fct_customer_orders ...... [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:29:48.201267 [debug] [Thread-1 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:29:48.203783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:48.204781 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:29:48.204781 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:29:48.204781 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:29:48.205789 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m16:29:48.205789 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m16:29:48.205789 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:29:48.206789 [info ] [MainThread]: 
[0m16:29:48.206789 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m16:29:48.208792 [debug] [MainThread]: Command end result
[0m16:29:48.220341 [info ] [MainThread]: 
[0m16:29:48.221351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:48.221351 [info ] [MainThread]: 
[0m16:29:48.221351 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:29:48.223872 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:48.223872 after 6.71 seconds
[0m16:29:48.223872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970982590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9744A96C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9744AAF50>]}
[0m16:29:48.224875 [debug] [MainThread]: Flushing usage events
[0m16:33:37.226878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB2FC25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB5E15240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB5E17A60>]}


============================== 16:33:37.231886 | cc13572e-97ee-442d-91d0-fb482e66b577 ==============================
[0m16:33:37.231886 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:33:37.233061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:37.790400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB373BBB0>]}
[0m16:33:37.878523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB5DC32B0>]}
[0m16:33:37.879524 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:33:37.888106 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:33:37.904154 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:33:37.905160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6AF0F40>]}
[0m16:33:39.095236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.turing_sales.core.fct_customer_orders
[0m16:33:39.101760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F1C0D0>]}
[0m16:33:39.110283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F1C070>]}
[0m16:33:39.111791 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:33:39.111791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F1C1F0>]}
[0m16:33:39.113800 [info ] [MainThread]: 
[0m16:33:39.115307 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:39.118315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:33:39.118315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:39.799396 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:33:39.799396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:40.571746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F1F8E0>]}
[0m16:33:40.572755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:40.572755 [info ] [MainThread]: 
[0m16:33:40.576265 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:33:40.576265 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:33:40.577267 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:33:40.578266 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:33:40.577267 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:33:40.579266 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:33:40.579266 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:33:40.580266 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:33:40.581840 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:33:40.580266 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:33:40.582780 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:33:40.583781 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:33:40.583781 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:33:40.585289 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:33:40.586298 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:33:40.593809 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:33:40.597322 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:33:40.598322 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:33:40.600322 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:33:40.603841 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:33:40.605347 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:33:40.586298 => 16:33:40.605347
[0m16:33:40.606356 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:33:40.595314 => 16:33:40.605347
[0m16:33:40.607355 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:33:40.607355 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:33:40.598322 => 16:33:40.607355
[0m16:33:40.608355 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:33:40.601829 => 16:33:40.608355
[0m16:33:40.609354 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:33:40.639365 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:33:40.640367 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:33:40.640367 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:33:40.645385 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:33:40.649393 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:33:40.652905 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:33:40.652905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:40.653903 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:33:40.653903 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:33:40.656418 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:33:40.656418 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    Order_Date as date,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:33:40.658416 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:33:40.683976 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:33:40.711548 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:33:41.598541 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b02591fb-2ad2-46ef-966a-e6348f7dfbdf&page=queryresults
[0m16:33:41.634271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8379ee91-7e77-4917-a4c8-9f93f9061c03&page=queryresults
[0m16:33:41.645798 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:cb981fcc-c289-4db4-aa0a-520a490095be&page=queryresults
[0m16:33:41.651804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:991e5678-a29d-4dc4-9250-78037929aab6&page=queryresults
[0m16:33:42.220253 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:33:40.609354 => 16:33:42.219252
[0m16:33:42.220253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F2DEA0>]}
[0m16:33:42.224768 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:33:40.640367 => 16:33:42.224768
[0m16:33:42.221760 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:33:42.225768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F2DED0>]}
[0m16:33:42.226820 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:33:42.227820 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m16:33:42.227820 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:33:42.229824 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:33:42.228820 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:33:42.230822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m16:33:42.230822 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m16:33:42.234913 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:33:42.235914 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 16:33:42.231823 => 16:33:42.234913
[0m16:33:42.235914 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m16:33:42.239987 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:33:42.240983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:42.243085 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:33:42.332283 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:33:40.649393 => 16:33:42.332283
[0m16:33:42.333291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB700B550>]}
[0m16:33:42.334291 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m16:33:42.334291 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:33:42.417951 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:33:40.645385 => 16:33:42.417951
[0m16:33:42.418958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6CA5A80>]}
[0m16:33:42.419958 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m16:33:42.420956 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:33:42.420956 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:33:42.421957 [info ] [Thread-2 (]: 6 of 6 START sql view model turing_dbt_sales_dev.fct_customer_orders ........... [RUN]
[0m16:33:42.421957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customer_addresses, now model.turing_sales.fct_customer_orders)
[0m16:33:42.421957 [debug] [Thread-2 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:33:42.433212 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:33:42.434214 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:33:42.423400 => 16:33:42.434214
[0m16:33:42.434214 [debug] [Thread-2 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:33:42.437727 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:33:42.438727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:33:42.440730 [debug] [Thread-2 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
  OPTIONS()
  as with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final;


[0m16:33:43.122746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:38f02c7c-2817-47f3-986e-f9e8fe04fb59&page=queryresults
[0m16:33:43.434193 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:6f058118-4df7-4aab-a9c8-9a13503df60b&page=queryresults
[0m16:33:43.698661 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 16:33:42.235914 => 16:33:43.697662
[0m16:33:43.698661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB700AEC0>]}
[0m16:33:43.699661 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m16:33:43.700659 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m16:33:43.977095 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:33:42.434214 => 16:33:43.976089
[0m16:33:43.977095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc13572e-97ee-442d-91d0-fb482e66b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6CA5A80>]}
[0m16:33:43.978097 [info ] [Thread-2 (]: 6 of 6 OK created sql view model turing_dbt_sales_dev.fct_customer_orders ...... [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m16:33:43.979096 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:33:43.980096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:43.981602 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:33:43.981602 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:33:43.981602 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:33:43.982609 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:33:43.982609 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m16:33:43.982609 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m16:33:43.983609 [info ] [MainThread]: 
[0m16:33:43.983609 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m16:33:43.985612 [debug] [MainThread]: Command end result
[0m16:33:43.995825 [info ] [MainThread]: 
[0m16:33:43.996720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:43.996720 [info ] [MainThread]: 
[0m16:33:43.997721 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:33:43.998719 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:43.998719 after 6.86 seconds
[0m16:33:43.999719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB2FC25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6AF3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB6F1C4C0>]}
[0m16:33:43.999719 [debug] [MainThread]: Flushing usage events
[0m16:34:54.961320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2FF042500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A281FA7C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A281FA79D0>]}


============================== 16:34:54.964329 | c4060d5c-9cbf-4b8a-adb8-bbf751dc3657 ==============================
[0m16:34:54.964329 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:34:54.965836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:34:55.500054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2FF72A7A0>]}
[0m16:34:55.585885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282ADB280>]}
[0m16:34:55.586397 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:34:55.595436 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:34:55.610044 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:34:55.611550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282C87B50>]}
[0m16:34:56.748050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2830B80D0>]}
[0m16:34:56.757075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2830B8070>]}
[0m16:34:56.758076 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:34:56.758076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2830B81F0>]}
[0m16:34:56.760072 [info ] [MainThread]: 
[0m16:34:56.760072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:56.762585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:34:56.762585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:57.474273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:34:57.475777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:58.116001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2830BB970>]}
[0m16:34:58.117009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:58.117009 [info ] [MainThread]: 
[0m16:34:58.120020 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:34:58.121623 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:34:58.122534 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:34:58.123534 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:34:58.123534 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:34:58.124533 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:34:58.127047 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:34:58.124533 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:34:58.128047 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:34:58.126039 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:34:58.128047 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:34:58.129048 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:34:58.130048 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:34:58.130048 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:34:58.141242 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:34:58.141242 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:34:58.145762 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:34:58.145762 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:34:58.149770 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:34:58.154287 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:34:58.155795 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:34:58.131554 => 16:34:58.154287
[0m16:34:58.156804 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:34:58.142253 => 16:34:58.155795
[0m16:34:58.156804 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:34:58.157804 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:34:58.158803 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:34:58.146770 => 16:34:58.157804
[0m16:34:58.167833 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:34:58.149770 => 16:34:58.167833
[0m16:34:58.189941 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:34:58.194454 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:34:58.195961 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:34:58.196970 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:34:58.199970 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:34:58.204486 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:34:58.205995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:58.207003 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:34:58.208001 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:34:58.210001 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    Order_Date as date,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:34:58.210001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:34:58.236570 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:34:58.265721 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:34:58.293452 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:34:59.224571 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1934839b-4392-45a0-9a78-bfcdc49da215&page=queryresults
[0m16:34:59.230093 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:dc0ed0c4-63fe-43a9-a09e-206eed2337f1&page=queryresults
[0m16:34:59.235607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:39c3b101-5425-4083-9e17-43e6647e7c84&page=queryresults
[0m16:34:59.236114 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:9ce39396-5665-4df9-b0b3-9500e9849b66&page=queryresults
[0m16:34:59.782454 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:34:58.191447 => 16:34:59.782454
[0m16:34:59.783452 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A283164AF0>]}
[0m16:34:59.786962 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:34:58.201478 => 16:34:59.785956
[0m16:34:59.789962 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:34:58.196970 => 16:34:59.788963
[0m16:34:59.786962 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m16:34:59.789962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282FF9AB0>]}
[0m16:34:59.791468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2830C1E70>]}
[0m16:34:59.791468 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:34:59.792478 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m16:34:59.793473 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_products
[0m16:34:59.792478 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m16:34:59.794474 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:34:59.795982 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:34:59.794474 [info ] [Thread-2 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:34:59.796990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customer_addresses, now model.turing_sales.stg_products)
[0m16:34:59.797992 [debug] [Thread-4 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:34:59.797992 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_products
[0m16:34:59.802500 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:34:59.798988 [info ] [Thread-4 (]: 6 of 6 START sql table model turing_dbt_sales_dev.fct_customer_orders .......... [RUN]
[0m16:34:59.803502 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_orders, now model.turing_sales.fct_customer_orders)
[0m16:34:59.804500 [debug] [Thread-4 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:34:59.808011 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:34:59.812530 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:34:58.158803 => 16:34:59.812530
[0m16:34:59.813530 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_products (compile): 16:34:59.798988 => 16:34:59.812530
[0m16:34:59.814530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A283208550>]}
[0m16:34:59.814530 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_products
[0m16:34:59.815530 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:34:59.804500 => 16:34:59.815530
[0m16:34:59.815530 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m16:34:59.824078 [debug] [Thread-4 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:34:59.828191 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:34:59.829190 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:34:59.841559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:59.843564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:59.870025 [debug] [Thread-2 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:35:00.835796 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:35:00.836805 [debug] [Thread-4 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
      
    
    

    OPTIONS()
    as (
      with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final
    );
  
[0m16:35:00.855846 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:15919c28-5475-4619-81f0-7d0d582ad8b5&page=queryresults
[0m16:35:01.463517 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_products (execute): 16:34:59.816567 => 16:35:01.463517
[0m16:35:01.464518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282C87010>]}
[0m16:35:01.465516 [info ] [Thread-2 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m16:35:01.465516 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_products
[0m16:35:01.606965 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:87cabcee-f7b9-4426-b418-d9f01a6a0868&page=queryresults
[0m16:35:04.997827 [debug] [Thread-4 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:34:59.829190 => 16:35:04.997827
[0m16:35:04.998826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4060d5c-9cbf-4b8a-adb8-bbf751dc3657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2831D2F50>]}
[0m16:35:04.998826 [info ] [Thread-4 (]: 6 of 6 OK created sql table model turing_dbt_sales_dev.fct_customer_orders ..... [[32mCREATE TABLE (69.4k rows, 1.3 MiB processed)[0m in 5.20s]
[0m16:35:04.999827 [debug] [Thread-4 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:35:05.002341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:05.002341 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:35:05.003342 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:35:05.003342 [debug] [MainThread]: Connection 'model.turing_sales.dim_dates' was properly closed.
[0m16:35:05.003342 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:35:05.004340 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m16:35:05.004340 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:35:05.004340 [info ] [MainThread]: 
[0m16:35:05.004340 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m16:35:05.006855 [debug] [MainThread]: Command end result
[0m16:35:05.015877 [info ] [MainThread]: 
[0m16:35:05.016887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:05.016887 [info ] [MainThread]: 
[0m16:35:05.017886 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:35:05.019886 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:05.019886 after 10.11 seconds
[0m16:35:05.019886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2FF042500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282FF9AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A282C86D10>]}
[0m16:35:05.019886 [debug] [MainThread]: Flushing usage events
[0m16:36:46.435690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136117625C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136145B5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136145B7A60>]}


============================== 16:36:46.439697 | 100144dc-5e03-43de-804d-d9c7716afb9e ==============================
[0m16:36:46.439697 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:36:46.440698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:46.978022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013611ED7BB0>]}
[0m16:36:47.065884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136150E8940>]}
[0m16:36:47.067035 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m16:36:47.077663 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:36:47.093876 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:36:47.094878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013615298850>]}
[0m16:36:48.254197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136156D00D0>]}
[0m16:36:48.263229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136156D0070>]}
[0m16:36:48.264230 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:36:48.264230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136156D01F0>]}
[0m16:36:48.266742 [info ] [MainThread]: 
[0m16:36:48.267742 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:48.269743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m16:36:48.269743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:48.969609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m16:36:48.969609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:49.569018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136156D37C0>]}
[0m16:36:49.569018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:49.570017 [info ] [MainThread]: 
[0m16:36:49.573348 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m16:36:49.573348 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m16:36:49.574350 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m16:36:49.574350 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m16:36:49.574350 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m16:36:49.575859 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m16:36:49.577867 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m16:36:49.576871 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m16:36:49.579866 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m16:36:49.577867 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m16:36:49.580870 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m16:36:49.581381 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m16:36:49.581381 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m16:36:49.582393 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m16:36:49.591421 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m16:36:49.591421 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m16:36:49.594428 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m16:36:49.595935 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m16:36:49.598955 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m16:36:49.602994 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m16:36:49.603992 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 16:36:49.583391 => 16:36:49.603992
[0m16:36:49.604992 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m16:36:49.617237 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 16:36:49.599950 => 16:36:49.617237
[0m16:36:49.618239 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 16:36:49.592429 => 16:36:49.618239
[0m16:36:49.619241 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 16:36:49.595935 => 16:36:49.618239
[0m16:36:49.637112 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m16:36:49.637112 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m16:36:49.638114 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m16:36:49.639110 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m16:36:49.643181 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m16:36:49.646694 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m16:36:49.649698 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m16:36:49.650697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:49.651728 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:36:49.651728 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:36:49.652723 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:36:49.653724 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source as (
    select distinct Order_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    row_number() over () as Date_ID,
    Order_Date as date,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source
)

select * from dates;


[0m16:36:49.655723 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as Address_ID,
        Customer_ID,
        Country,
        City,
        State,
        Postal_Code,
        Region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m16:36:49.682363 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID,
    Order_Date,
    Ship_Date,
    Ship_Mode,
    Customer_ID,
    Sales as Sale_Ammount
from source

)

select * from orders;


[0m16:36:49.683364 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID,
    Customer_Name,
    Segment
from source

)

select * from customers;


[0m16:36:50.607575 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:14e1eb90-5b5a-4c3b-94a7-0530916b1873&page=queryresults
[0m16:36:50.634636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e9ddbeb9-08d4-4271-9258-e0e0be42a144&page=queryresults
[0m16:36:50.685536 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3dc39692-ea3c-40f2-8e5d-71cb2d45cf9b&page=queryresults
[0m16:36:50.934117 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:fb855a48-ca44-4b52-9db6-070856456d05&page=queryresults
[0m16:36:51.168847 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 16:36:49.604992 => 16:36:51.168847
[0m16:36:51.169848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136151D0850>]}
[0m16:36:51.170848 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m16:36:51.171357 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m16:36:51.172365 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m16:36:51.172365 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m16:36:51.173364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m16:36:51.174365 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m16:36:51.177879 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m16:36:51.178876 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 16:36:51.174365 => 16:36:51.178876
[0m16:36:51.179876 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m16:36:51.182392 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m16:36:51.185893 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 16:36:49.643181 => 16:36:51.184389
[0m16:36:51.186903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013615850310>]}
[0m16:36:51.187904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:51.186903 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m16:36:51.188901 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m16:36:51.190901 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID,
    Category,
    Sub_Category,
    Product_Name
from source

)

select * from products;


[0m16:36:51.278663 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 16:36:49.639110 => 16:36:51.278663
[0m16:36:51.279663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013615775F00>]}
[0m16:36:51.280661 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m16:36:51.280661 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m16:36:51.495806 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 16:36:49.646694 => 16:36:51.495806
[0m16:36:51.498092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136158503A0>]}
[0m16:36:51.498092 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m16:36:51.500093 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m16:36:51.500093 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m16:36:51.501094 [info ] [Thread-2 (]: 6 of 6 START sql table model turing_dbt_sales_dev.fct_customer_orders .......... [RUN]
[0m16:36:51.501094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customer_addresses, now model.turing_sales.fct_customer_orders)
[0m16:36:51.502319 [debug] [Thread-2 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m16:36:51.511341 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m16:36:51.511847 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 16:36:51.502319 => 16:36:51.511847
[0m16:36:51.512855 [debug] [Thread-2 (]: Began executing node model.turing_sales.fct_customer_orders
[0m16:36:51.542962 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m16:36:51.543964 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:51.545961 [debug] [Thread-2 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
      
    
    

    OPTIONS()
    as (
      with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.Customer_ID,
        orders.Order_ID,
        customer_addresses.Address_ID,
        orders.Sale_Ammount as order_ammount_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final
    );
  
[0m16:36:52.101444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3462b547-9573-466b-8179-dbe47ffa80d1&page=queryresults
[0m16:36:52.588662 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:5f516d8f-4039-4f6b-bc28-954e664963e5&page=queryresults
[0m16:36:52.649384 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 16:36:51.179876 => 16:36:52.649384
[0m16:36:52.649384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136151D0850>]}
[0m16:36:52.650890 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m16:36:52.651901 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m16:36:55.314590 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 16:36:51.512855 => 16:36:55.314590
[0m16:36:55.315595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100144dc-5e03-43de-804d-d9c7716afb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361575AA10>]}
[0m16:36:55.315595 [info ] [Thread-2 (]: 6 of 6 OK created sql table model turing_dbt_sales_dev.fct_customer_orders ..... [[32mCREATE TABLE (69.4k rows, 1.3 MiB processed)[0m in 3.81s]
[0m16:36:55.316602 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m16:36:55.318602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:55.318602 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m16:36:55.318602 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m16:36:55.319605 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m16:36:55.319605 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m16:36:55.319605 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m16:36:55.320604 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m16:36:55.320604 [info ] [MainThread]: 
[0m16:36:55.321736 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m16:36:55.323737 [debug] [MainThread]: Command end result
[0m16:36:55.334673 [info ] [MainThread]: 
[0m16:36:55.334673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:55.335675 [info ] [MainThread]: 
[0m16:36:55.336754 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:36:55.337753 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:55.337753 after 8.96 seconds
[0m16:36:55.337753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136117625C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136157ABEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013615858CA0>]}
[0m16:36:55.338752 [debug] [MainThread]: Flushing usage events
[0m17:49:36.492736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59B742530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59E595180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59E597970>]}


============================== 17:49:36.497743 | 4a894447-0d44-49c3-9659-2cda2327e985 ==============================
[0m17:49:36.497743 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:49:36.498744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:49:37.198691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59BF1EF80>]}
[0m17:49:37.287130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F0CF1F0>]}
[0m17:49:37.288131 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:49:37.297892 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:49:37.425799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m17:49:37.426797 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customer_addresses.sql
[0m17:49:37.426797 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_orders.sql
[0m17:49:37.427798 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m17:49:37.427798 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_customers.sql
[0m17:49:37.427798 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m17:49:37.428798 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\staging\superstore\stg_products.sql
[0m17:49:37.578818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F601060>]}
[0m17:49:37.590349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F489B70>]}
[0m17:49:37.591356 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:49:37.591356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F489A20>]}
[0m17:49:37.593871 [info ] [MainThread]: 
[0m17:49:37.593871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:37.595870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:49:37.596874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:38.492711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:49:38.493719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.211527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F488790>]}
[0m17:49:39.211527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:39.212529 [info ] [MainThread]: 
[0m17:49:39.216669 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:49:39.217671 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:49:39.217671 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:49:39.217671 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:49:39.218670 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:49:39.218670 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:49:39.218670 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:49:39.221187 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:49:39.220281 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:49:39.222700 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:49:39.223708 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:49:39.224708 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:49:39.224708 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:49:39.225709 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:49:39.225709 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:49:39.234741 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:49:39.234741 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:49:39.238737 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:49:39.241249 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:49:39.245764 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:49:39.247768 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:49:39.226708 => 17:49:39.246767
[0m17:49:39.250276 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:49:39.248766 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:49:39.235740 => 17:49:39.247768
[0m17:49:39.248766 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:49:39.238737 => 17:49:39.248766
[0m17:49:39.266851 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:49:39.267852 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:49:39.242757 => 17:49:39.267852
[0m17:49:39.293960 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:49:39.294960 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:49:39.298960 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:49:39.301476 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:49:39.305633 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:49:39.309138 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:49:39.310144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:39.310144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:39.311209 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:49:39.311209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:49:39.313721 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:49:39.315723 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:49:39.316725 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
    union
    select distinct Ship_Date as date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    date,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source_dates
)

select * from dates;


[0m17:49:39.368857 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:49:40.105788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8aa7dc71-1caa-4d05-95a8-a7e05d7a30ba&page=queryresults
[0m17:49:40.105788 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]')
[0m17:49:40.361139 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:eccd2eb4-aa44-4302-aea6-8b7b3ed3f680&page=queryresults
[0m17:49:40.373674 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e96f00ba-86f3-41a4-9f96-369686b1482a&page=queryresults
[0m17:49:40.661100 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:d0fa2f5c-e523-48dd-a242-48771d37a008&page=queryresults
[0m17:49:40.940367 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:49:39.302471 => 17:49:40.940367
[0m17:49:40.941375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F4892D0>]}
[0m17:49:40.941375 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m17:49:40.942880 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:49:40.942880 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_products
[0m17:49:40.943888 [info ] [Thread-3 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:49:40.944888 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customers, now model.turing_sales.stg_products)
[0m17:49:40.944888 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_products
[0m17:49:40.948888 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:49:40.948888 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_products (compile): 17:49:40.944888 => 17:49:40.948888
[0m17:49:40.950397 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_products
[0m17:49:40.954934 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:49:40.955933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:49:40.957934 [debug] [Thread-3 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:49:40.985967 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:49:39.294960 => 17:49:40.985967
[0m17:49:40.987968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F698E50>]}
[0m17:49:40.988967 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m17:49:40.990475 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:49:41.025841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:251b67d7-1620-4203-b08b-9608dc8d75d7&page=queryresults
[0m17:49:41.026841 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:251b67d7-1620-4203-b08b-9608dc8d75d7&page=queryresults
[0m17:49:41.027841 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:49:39.251285 => 17:49:41.026841
[0m17:49:41.141331 [debug] [Thread-1 (]: Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:49:41.141331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F6E3400>]}
[0m17:49:41.142839 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model turing_dbt_sales_dev.dim_dates ............ [[31mERROR[0m in 1.92s]
[0m17:49:41.143846 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:49:41.306838 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:49:39.305633 => 17:49:41.306838
[0m17:49:41.307838 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F69B790>]}
[0m17:49:41.309344 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m17:49:41.309344 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:49:41.310850 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:49:41.311859 [info ] [Thread-2 (]: 6 of 6 SKIP relation turing_dbt_sales_dev.fct_customer_orders .................. [[33mSKIP[0m]
[0m17:49:41.312859 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:49:42.321395 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:6e8f1e48-3a1e-48ee-bfe5-0fb34175c107&page=queryresults
[0m17:49:42.881282 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_products (execute): 17:49:40.950397 => 17:49:42.881282
[0m17:49:42.882791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a894447-0d44-49c3-9659-2cda2327e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F4883A0>]}
[0m17:49:42.883800 [info ] [Thread-3 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m17:49:42.884799 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_products
[0m17:49:42.885800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:42.886799 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:49:42.886799 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:49:42.887800 [debug] [MainThread]: Connection 'model.turing_sales.dim_dates' was properly closed.
[0m17:49:42.887800 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:49:42.887800 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:49:42.888800 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:49:42.888800 [info ] [MainThread]: 
[0m17:49:42.888800 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m17:49:42.891318 [debug] [MainThread]: Command end result
[0m17:49:42.911893 [info ] [MainThread]: 
[0m17:49:42.912895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:42.913401 [info ] [MainThread]: 
[0m17:49:42.913401 [error] [MainThread]:   Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:49:42.914412 [info ] [MainThread]: 
[0m17:49:42.915409 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:49:42.916410 [debug] [MainThread]: Command `dbt run` failed at 17:49:42.916410 after 6.47 seconds
[0m17:49:42.917411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59B742530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F2B82B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F2B8910>]}
[0m17:49:42.917411 [debug] [MainThread]: Flushing usage events
[0m17:51:48.178628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F200B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F4E75270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F4E772E0>]}


============================== 17:51:48.183393 | 5c1d31de-daa5-4e35-bbe8-700758c68928 ==============================
[0m17:51:48.183393 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:51:48.184390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:48.760934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F4E23FD0>]}
[0m17:51:48.853332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5ABEBF0>]}
[0m17:51:48.855339 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:51:48.862859 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:51:48.951580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:48.952579 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m17:51:49.085974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5EF18D0>]}
[0m17:51:49.096577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D665C0>]}
[0m17:51:49.096577 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:51:49.097575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D66470>]}
[0m17:51:49.098575 [info ] [MainThread]: 
[0m17:51:49.099576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:49.101795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:51:49.102790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:49.821939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:51:49.821939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:50.578739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D652A0>]}
[0m17:51:50.579741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:50.581000 [info ] [MainThread]: 
[0m17:51:50.584513 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:51:50.584513 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:51:50.585514 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:51:50.586515 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:51:50.585514 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:51:50.586515 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:51:50.589516 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:51:50.587515 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:51:50.589516 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:51:50.590992 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:51:50.588514 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:51:50.590992 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:51:50.592496 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:51:50.601553 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:51:50.602550 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:51:50.602550 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:51:50.606031 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:51:50.607034 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:51:50.610550 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:51:50.613766 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:51:50.614765 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:51:50.592496 => 17:51:50.614765
[0m17:51:50.615763 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:51:50.615763 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:51:50.602550 => 17:51:50.615763
[0m17:51:50.643441 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:51:50.607034 => 17:51:50.642932
[0m17:51:50.643441 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:51:50.644448 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:51:50.610550 => 17:51:50.643441
[0m17:51:50.650963 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:51:50.650963 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:51:50.654476 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:51:50.654476 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:51:50.659482 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:51:50.662502 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:51:50.664510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:50.664510 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:51:50.666508 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
    union
    select distinct Ship_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
select
    date_iso,
    extract(year from Order_Date) as year,
    extract(month from Order_Date) as month,
    extract(day from Order_Date) as day
from source_dates
)

select * from dates;


[0m17:51:50.667508 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:51:50.667508 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:51:50.692928 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:51:50.720573 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:51:50.747147 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:51:51.393549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b6c69783-3373-486b-8eb0-fefc006a19bf&page=queryresults
[0m17:51:51.394551 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]')
[0m17:51:51.651239 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:225a77cc-3b0e-4d03-b719-850e6a740f51&page=queryresults
[0m17:51:51.657751 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3fc4aea6-2b4f-4f17-bf94-5899674ac861&page=queryresults
[0m17:51:51.729464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:609df5ee-0a72-432a-9766-26ca788dc0cd&page=queryresults
[0m17:51:51.730468 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:609df5ee-0a72-432a-9766-26ca788dc0cd&page=queryresults
[0m17:51:51.731469 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:51:50.615763 => 17:51:51.730468
[0m17:51:51.735999 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:3f3022ad-9565-434c-be7a-93aa2c3fc2e6&page=queryresults
[0m17:51:51.739502 [debug] [Thread-1 (]: Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:51:51.740512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D65CF0>]}
[0m17:51:51.741511 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model turing_dbt_sales_dev.dim_dates ............ [[31mERROR[0m in 1.15s]
[0m17:51:51.741511 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:51:51.742510 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m17:51:51.742510 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:51:51.743636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m17:51:51.744633 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m17:51:51.748637 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:51:51.749637 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 17:51:51.744633 => 17:51:51.749637
[0m17:51:51.750803 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m17:51:51.755025 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:51:51.756033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:51.758032 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:51:52.253784 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:51:50.655480 => 17:51:52.253784
[0m17:51:52.254784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F701C430>]}
[0m17:51:52.257784 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:51:50.650963 => 17:51:52.257784
[0m17:51:52.255783 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m17:51:52.258785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D66140>]}
[0m17:51:52.259784 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:51:52.260874 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m17:51:52.261873 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:51:52.313980 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:51:50.659988 => 17:51:52.313980
[0m17:51:52.314987 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D65FC0>]}
[0m17:51:52.314987 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m17:51:52.316986 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:51:52.316986 [debug] [Thread-3 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:51:52.317986 [info ] [Thread-3 (]: 6 of 6 SKIP relation turing_dbt_sales_dev.fct_customer_orders .................. [[33mSKIP[0m]
[0m17:51:52.317986 [debug] [Thread-3 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:51:52.710017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8321da22-1d59-4fb9-a502-c9d7719eb036&page=queryresults
[0m17:51:53.262932 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 17:51:51.750803 => 17:51:53.262932
[0m17:51:53.263438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d31de-daa5-4e35-bbe8-700758c68928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5EF2350>]}
[0m17:51:53.264447 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m17:51:53.265445 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m17:51:53.267448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:53.267448 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:51:53.268446 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:51:53.268446 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:51:53.268446 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:51:53.269447 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m17:51:53.269447 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:51:53.269955 [info ] [MainThread]: 
[0m17:51:53.270459 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m17:51:53.271468 [debug] [MainThread]: Command end result
[0m17:51:53.292566 [info ] [MainThread]: 
[0m17:51:53.293576 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:53.294576 [info ] [MainThread]: 
[0m17:51:53.294576 [error] [MainThread]:   Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:51:53.295578 [info ] [MainThread]: 
[0m17:51:53.296575 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:51:53.297575 [debug] [MainThread]: Command `dbt run` failed at 17:51:53.297575 after 5.19 seconds
[0m17:51:53.298574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F200B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2EFE8A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5B191E0>]}
[0m17:51:53.298574 [debug] [MainThread]: Flushing usage events
[0m17:53:50.357558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6C93B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6F7A50F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6F7A7130>]}


============================== 17:53:50.362653 | 2adefa40-33e4-48e4-9b37-1006c3bb76b8 ==============================
[0m17:53:50.362653 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:53:50.363584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:50.923779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6F753E20>]}
[0m17:53:51.011335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6ED087C0>]}
[0m17:53:51.012842 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:53:51.020364 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:53:51.102789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:51.103732 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m17:53:51.236971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B70819630>]}
[0m17:53:51.246006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7069A260>]}
[0m17:53:51.247006 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:53:51.248003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7069A230>]}
[0m17:53:51.249005 [info ] [MainThread]: 
[0m17:53:51.250324 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:51.251322 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:53:51.252828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:51.979174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:53:51.980183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:52.662902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B70698F40>]}
[0m17:53:52.663817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:52.664817 [info ] [MainThread]: 
[0m17:53:52.667815 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:53:52.667815 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:53:52.669321 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:53:52.669321 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:53:52.670331 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:53:52.670331 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:53:52.673850 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:53:52.671329 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:53:52.674847 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:53:52.671329 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:53:52.674847 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:53:52.675845 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:53:52.676847 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:53:52.677848 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:53:52.686887 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:53:52.687890 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:53:52.690970 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:53:52.691971 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:53:52.696058 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:53:52.699058 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:53:52.700200 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:53:52.677848 => 17:53:52.699058
[0m17:53:52.701199 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:53:52.701199 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:53:52.688888 => 17:53:52.701199
[0m17:53:52.701199 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:53:52.691971 => 17:53:52.701199
[0m17:53:52.735341 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:53:52.736341 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:53:52.737340 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:53:52.696058 => 17:53:52.737340
[0m17:53:52.737340 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:53:52.741849 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:53:52.741849 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:53:52.746978 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:53:52.751378 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:53:52.751378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:52.752884 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:53:52.752884 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:53:52.754892 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:53:52.754892 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:53:52.756894 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
    union
    select distinct Ship_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
    select
        date_iso,
        extract(year from Order_Date) as year,
        extract(month from Order_Date) as month,
        extract(day from Order_Date) as day
    from source_dates
)

select * from dates;


[0m17:53:52.783557 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:53:52.837780 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:53:53.758135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:4199142a-5b96-4ccd-b120-327dde378536&page=queryresults
[0m17:53:53.759136 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]')
[0m17:53:53.906523 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:569d607e-cdf1-40df-8acd-dd58c5812af2&page=queryresults
[0m17:53:53.906523 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:35093d83-ee41-4f78-88e9-08465cd2d371&page=queryresults
[0m17:53:53.939219 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b8b6e007-1902-4b9e-83b2-04f62b66cf19&page=queryresults
[0m17:53:54.225717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1f25196a-52b8-4749-9241-52551031e9d4&page=queryresults
[0m17:53:54.225717 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1f25196a-52b8-4749-9241-52551031e9d4&page=queryresults
[0m17:53:54.227717 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:53:52.702711 => 17:53:54.227717
[0m17:53:54.232746 [debug] [Thread-1 (]: Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:53:54.233251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B708AFF40>]}
[0m17:53:54.234259 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model turing_dbt_sales_dev.dim_dates ............ [[31mERROR[0m in 1.56s]
[0m17:53:54.235266 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:53:54.235266 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m17:53:54.236267 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:53:54.237267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m17:53:54.238270 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m17:53:54.240788 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:53:54.242788 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 17:53:54.238270 => 17:53:54.241789
[0m17:53:54.243297 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m17:53:54.247304 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:53:54.248305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:54.250827 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:53:54.483750 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:53:52.742853 => 17:53:54.482743
[0m17:53:54.484753 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7081BEE0>]}
[0m17:53:54.489257 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:53:52.746978 => 17:53:54.489257
[0m17:53:54.485752 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m17:53:54.491262 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B708AFB50>]}
[0m17:53:54.494779 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:53:52.738342 => 17:53:54.494779
[0m17:53:54.495784 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:53:54.497780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7194C7C0>]}
[0m17:53:54.496780 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m17:53:54.499289 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:53:54.497780 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m17:53:54.500301 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:53:54.501295 [debug] [Thread-3 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:53:54.501295 [info ] [Thread-3 (]: 6 of 6 SKIP relation turing_dbt_sales_dev.fct_customer_orders .................. [[33mSKIP[0m]
[0m17:53:54.502802 [debug] [Thread-3 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:53:55.180963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b18bd7da-257f-44fa-bfe6-2d5f9649d4bc&page=queryresults
[0m17:53:55.784035 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 17:53:54.244307 => 17:53:55.784035
[0m17:53:55.785035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2adefa40-33e4-48e4-9b37-1006c3bb76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B70679F30>]}
[0m17:53:55.786036 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m17:53:55.787034 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m17:53:55.789039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:55.789039 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:53:55.789552 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:53:55.789552 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:53:55.789552 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:53:55.790562 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m17:53:55.790562 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:53:55.791561 [info ] [MainThread]: 
[0m17:53:55.791561 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m17:53:55.793670 [debug] [MainThread]: Command end result
[0m17:53:55.814744 [info ] [MainThread]: 
[0m17:53:55.814744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:55.815743 [info ] [MainThread]: 
[0m17:53:55.816741 [error] [MainThread]:   Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:53:55.816741 [info ] [MainThread]: 
[0m17:53:55.817741 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:53:55.819247 [debug] [MainThread]: Command `dbt run` failed at 17:53:55.819247 after 5.52 seconds
[0m17:53:55.819247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B6C93B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B708FBAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7092BFA0>]}
[0m17:53:55.820256 [debug] [MainThread]: Flushing usage events
[0m17:55:28.970216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192153AB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019218215270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192182172E0>]}


============================== 17:55:28.974726 | 8e75d02f-35eb-4d24-b32f-19a240c28b08 ==============================
[0m17:55:28.974726 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:55:28.975726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:29.516447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192159FBC10>]}
[0m17:55:29.605813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019218F38EE0>]}
[0m17:55:29.607812 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:55:29.617411 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:55:29.704900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:29.705899 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m17:55:29.838865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219288E50>]}
[0m17:55:29.848665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219109B40>]}
[0m17:55:29.848665 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:55:29.849678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192191099F0>]}
[0m17:55:29.851675 [info ] [MainThread]: 
[0m17:55:29.853188 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:29.854215 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:55:29.855196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:30.658665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:55:30.659711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:31.571738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219108760>]}
[0m17:55:31.572738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:55:31.572738 [info ] [MainThread]: 
[0m17:55:31.576085 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:55:31.576085 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:55:31.577087 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:55:31.577087 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:55:31.577087 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:55:31.578595 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:55:31.579600 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:55:31.580603 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:55:31.579600 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:55:31.581600 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:55:31.582601 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:55:31.583107 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:55:31.584115 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:55:31.584115 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:55:31.585118 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:55:31.593840 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:55:31.593840 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:55:31.597843 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:55:31.601129 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:55:31.604251 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:55:31.605257 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:55:31.585118 => 17:55:31.605257
[0m17:55:31.606260 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:55:31.617858 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:55:31.594841 => 17:55:31.617858
[0m17:55:31.633526 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:55:31.597843 => 17:55:31.633526
[0m17:55:31.640590 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:55:31.641589 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:55:31.641589 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:55:31.642591 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:55:31.601129 => 17:55:31.642591
[0m17:55:31.645822 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:55:31.651103 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:55:31.651103 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:55:31.652610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:31.656619 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:55:31.657620 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:55:31.659129 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:55:31.660137 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
    union
    select distinct Ship_Date from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
    select
        date_iso,
        extract(year from date_iso) as year,
        extract(month from date_iso) as month,
        extract(day from date_iso) as day
    from source_dates
)

select * from dates;


[0m17:55:31.661140 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:55:31.661140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:55:31.716221 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:55:31.744057 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:55:32.418675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:5d23003d-033c-4dd1-b741-2be18d5cb392&page=queryresults
[0m17:55:32.419683 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]')
[0m17:55:32.682993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:ab1cbab6-2cf8-4ef9-bd01-faf2c5ca985b&page=queryresults
[0m17:55:32.745643 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:d69d1347-4e59-43e0-82a3-216bbac2c382&page=queryresults
[0m17:55:32.868521 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:1e9affcf-6d72-4804-a81a-fe031790d5d3&page=queryresults
[0m17:55:33.171738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:5281af7a-1369-4747-8bd9-fa6f446cb885&page=queryresults
[0m17:55:33.172740 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:5281af7a-1369-4747-8bd9-fa6f446cb885&page=queryresults
[0m17:55:33.172740 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:55:31.606260 => 17:55:33.172740
[0m17:55:33.177843 [debug] [Thread-1 (]: Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:55:33.177843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219109270>]}
[0m17:55:33.178842 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model turing_dbt_sales_dev.dim_dates ............ [[31mERROR[0m in 1.60s]
[0m17:55:33.180365 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:55:33.180365 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m17:55:33.181363 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:55:33.181363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m17:55:33.181363 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m17:55:33.185881 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:55:33.186880 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 17:55:33.182873 => 17:55:33.185881
[0m17:55:33.186880 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m17:55:33.189926 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:55:33.190927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:33.192924 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:55:33.301078 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:55:31.642591 => 17:55:33.301078
[0m17:55:33.302586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219109540>]}
[0m17:55:33.303595 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m17:55:33.303595 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:55:33.379256 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:55:31.646820 => 17:55:33.379256
[0m17:55:33.380264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001921931E4D0>]}
[0m17:55:33.381263 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m17:55:33.381263 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:55:33.544989 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:55:31.652610 => 17:55:33.544989
[0m17:55:33.545990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192193CFCD0>]}
[0m17:55:33.546990 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m17:55:33.546990 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:55:33.548495 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:55:33.548495 [info ] [Thread-2 (]: 6 of 6 SKIP relation turing_dbt_sales_dev.fct_customer_orders .................. [[33mSKIP[0m]
[0m17:55:33.549501 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:55:34.233845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:717638b2-3bb6-4f9a-ab3a-a3277e2f95eb&page=queryresults
[0m17:55:34.870675 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 17:55:33.186880 => 17:55:34.870675
[0m17:55:34.871674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e75d02f-35eb-4d24-b32f-19a240c28b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019219355A80>]}
[0m17:55:34.872674 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m17:55:34.872674 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m17:55:34.875157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:34.875157 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:55:34.876155 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:55:34.876155 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:55:34.876155 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:55:34.877157 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m17:55:34.877157 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:55:34.877157 [info ] [MainThread]: 
[0m17:55:34.877157 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m17:55:34.879673 [debug] [MainThread]: Command end result
[0m17:55:34.898729 [info ] [MainThread]: 
[0m17:55:34.899832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:34.900830 [info ] [MainThread]: 
[0m17:55:34.900830 [error] [MainThread]:   Database Error in model dim_dates (models\dimensions\superstore\dim_dates.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [11:5]
  compiled Code at target\run\turing_sales\models\dimensions\superstore\dim_dates.sql
[0m17:55:34.901831 [info ] [MainThread]: 
[0m17:55:34.902832 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:55:34.903870 [debug] [MainThread]: Command `dbt run` failed at 17:55:34.903870 after 5.98 seconds
[0m17:55:34.903870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192153AB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019218F39210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001921936F010>]}
[0m17:55:34.904872 [debug] [MainThread]: Flushing usage events
[0m17:56:39.186615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A70DC925C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A710AE5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A710AE7A60>]}


============================== 17:56:39.190129 | f42f2a79-175a-44a6-b70f-28380eeda38d ==============================
[0m17:56:39.190129 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:39.191132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'fail_fast': 'False', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:56:39.731227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A710A97DC0>]}
[0m17:56:39.823624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A710048790>]}
[0m17:56:39.824623 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:56:39.833651 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:39.921158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:39.921158 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\dimensions\superstore\dim_dates.sql
[0m17:56:40.054883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711B595D0>]}
[0m17:56:40.063909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7119DA200>]}
[0m17:56:40.063909 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:56:40.064909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7119DA1D0>]}
[0m17:56:40.066910 [info ] [MainThread]: 
[0m17:56:40.066910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:40.069423 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:56:40.069423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:41.043779 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:56:41.044936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:41.990561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7119D8EE0>]}
[0m17:56:41.991561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:41.991561 [info ] [MainThread]: 
[0m17:56:41.994636 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:56:41.995640 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:56:41.995640 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:56:41.996637 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:56:41.996637 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:56:41.998147 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:56:41.999155 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:56:41.998147 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:56:42.000160 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:56:41.999155 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:56:42.001156 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:56:42.001156 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:56:42.001156 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:56:42.002665 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:56:42.013704 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:56:42.014704 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:56:42.016703 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:56:42.018211 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:56:42.021217 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:56:42.024732 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:56:42.025733 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:56:42.003674 => 17:56:42.025733
[0m17:56:42.026735 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:56:42.058163 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:56:42.059172 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:56:42.019221 => 17:56:42.058163
[0m17:56:42.060171 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:56:42.014704 => 17:56:42.059172
[0m17:56:42.060171 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:56:42.022725 => 17:56:42.060171
[0m17:56:42.061171 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:56:42.061171 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:56:42.062682 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:56:42.065695 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:56:42.070208 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:56:42.071208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:42.074722 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:56:42.076732 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
    select
        date_iso,
        extract(year from date_iso) as year,
        extract(month from date_iso) as month,
        extract(day from date_iso) as day
    from source_dates
)

select * from dates;


[0m17:56:42.101299 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:56:42.102807 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:56:42.102807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:56:42.106815 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:56:42.106815 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:56:42.133879 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:56:43.161368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:f9ce9487-dc37-4016-a043-bee765db8a29&page=queryresults
[0m17:56:43.326745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:9d8c58cd-47f9-4655-95f1-b8398163ec90&page=queryresults
[0m17:56:43.394877 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:e80b1551-de64-4840-ac48-6f0b3fbd76ac&page=queryresults
[0m17:56:43.492593 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:5a67dba8-06f8-4203-8a61-3e9bf3e30668&page=queryresults
[0m17:56:43.801306 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:56:42.026735 => 17:56:43.801306
[0m17:56:43.802812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711C644C0>]}
[0m17:56:43.804820 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m17:56:43.805819 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:56:43.806820 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m17:56:43.806820 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:56:43.808326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m17:56:43.808326 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m17:56:43.811336 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:56:43.813848 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 17:56:43.809332 => 17:56:43.812842
[0m17:56:43.813848 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m17:56:43.816852 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:56:43.818358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:43.820366 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:56:43.937058 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:56:42.066697 => 17:56:43.937058
[0m17:56:43.937058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711BF0040>]}
[0m17:56:43.938563 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m17:56:43.939573 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:56:43.956961 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:56:42.062682 => 17:56:43.956961
[0m17:56:43.956961 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711BF3430>]}
[0m17:56:43.958468 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m17:56:43.959474 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:56:44.124331 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:56:42.071208 => 17:56:44.124331
[0m17:56:44.125330 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711BF2A10>]}
[0m17:56:44.125330 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m17:56:44.127331 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:56:44.127331 [debug] [Thread-2 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:56:44.128333 [info ] [Thread-2 (]: 6 of 6 START sql table model turing_dbt_sales_dev.fct_customer_orders .......... [RUN]
[0m17:56:44.128840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customer_addresses, now model.turing_sales.fct_customer_orders)
[0m17:56:44.129849 [debug] [Thread-2 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m17:56:44.133353 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m17:56:44.134360 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 17:56:44.129849 => 17:56:44.134360
[0m17:56:44.135367 [debug] [Thread-2 (]: Began executing node model.turing_sales.fct_customer_orders
[0m17:56:44.152506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:56:44.824658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:78ca2c06-cba4-4111-bb8e-0b570f3160ff&page=queryresults
[0m17:56:45.038258 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m17:56:45.039266 [debug] [Thread-2 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
      
    
    

    OPTIONS()
    as (
      with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

dates as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`

)

final as (
    select
        customers.customer_id,
        orders.order_id,
        customer_addresses.address_id,
        orders.order_date_id,
        orders.ship_date_id,
        orders.line_total_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final
    );
  
[0m17:56:45.364777 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:bcad063c-a9ad-4df7-bbab-f24b3aa37ac8&page=queryresults
[0m17:56:45.365778 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "final" at [37:1]')
[0m17:56:45.401377 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 17:56:43.813848 => 17:56:45.401377
[0m17:56:45.402887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7119D9F30>]}
[0m17:56:45.402887 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m17:56:45.403899 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m17:56:46.501949 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:00bedd80-b040-4d50-b0c0-3a353bfa56c4&page=queryresults
[0m17:56:46.502960 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:00bedd80-b040-4d50-b0c0-3a353bfa56c4&page=queryresults
[0m17:56:46.503968 [debug] [Thread-2 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 17:56:44.135367 => 17:56:46.502960
[0m17:56:46.506966 [debug] [Thread-2 (]: Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Unexpected identifier "final" at [37:1]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m17:56:46.508471 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42f2a79-175a-44a6-b70f-28380eeda38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A711B5AA10>]}
[0m17:56:46.508471 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model turing_dbt_sales_dev.fct_customer_orders . [[31mERROR[0m in 2.38s]
[0m17:56:46.509479 [debug] [Thread-2 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:56:46.511480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:46.512990 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:56:46.512990 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:56:46.512990 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:56:46.514002 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m17:56:46.514002 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m17:56:46.514002 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:56:46.515002 [info ] [MainThread]: 
[0m17:56:46.515002 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 6.45 seconds (6.45s).
[0m17:56:46.516997 [debug] [MainThread]: Command end result
[0m17:56:46.526030 [info ] [MainThread]: 
[0m17:56:46.527028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:46.527028 [info ] [MainThread]: 
[0m17:56:46.527028 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Syntax error: Unexpected identifier "final" at [37:1]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m17:56:46.528538 [info ] [MainThread]: 
[0m17:56:46.529547 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:56:46.530545 [debug] [MainThread]: Command `dbt run` failed at 17:56:46.530545 after 7.40 seconds
[0m17:56:46.531547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A70DC925C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7116BEB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7116F0B50>]}
[0m17:56:46.531547 [debug] [MainThread]: Flushing usage events
[0m17:57:20.451322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019382F3B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019385DA52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019385DA5930>]}


============================== 17:57:20.454837 | c47e9236-0be3-4f6d-ae16-9bed21aa994b ==============================
[0m17:57:20.454837 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:57:20.455844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:21.021368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938358B700>]}
[0m17:57:21.109172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019385D53340>]}
[0m17:57:21.110172 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:57:21.118190 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:57:21.203538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:21.203538 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m17:57:21.338043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386E25420>]}
[0m17:57:21.346718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C9A110>]}
[0m17:57:21.346718 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:57:21.348224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C9A0E0>]}
[0m17:57:21.349231 [info ] [MainThread]: 
[0m17:57:21.350230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:21.352738 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:57:21.352738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:22.105743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:57:22.106748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:22.879345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C98AF0>]}
[0m17:57:22.879345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:22.880348 [info ] [MainThread]: 
[0m17:57:22.883859 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:57:22.883859 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:57:22.884860 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:57:22.885859 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:57:22.884860 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:57:22.885859 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:57:22.888363 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:57:22.886858 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:57:22.889371 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:57:22.889371 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:57:22.886858 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:57:22.890375 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:57:22.891373 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:57:22.898935 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:57:22.899936 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:57:22.900935 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:57:22.905041 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:57:22.905041 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:57:22.908036 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:57:22.911402 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:57:22.912908 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:57:22.891373 => 17:57:22.911402
[0m17:57:22.912908 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:57:22.913919 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:57:22.900935 => 17:57:22.913919
[0m17:57:22.938116 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:57:22.945080 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:57:22.948581 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:57:22.949587 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:57:22.905041 => 17:57:22.948581
[0m17:57:22.949587 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:57:22.909401 => 17:57:22.949587
[0m17:57:22.950589 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:57:22.950589 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:57:22.954624 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:57:22.955622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:22.959144 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:57:22.960146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:57:22.961147 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
    select
        date_iso,
        extract(year from date_iso) as year,
        extract(month from date_iso) as month,
        extract(day from date_iso) as day
    from source_dates
)

select * from dates;


[0m17:57:22.986770 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:57:22.989285 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:22.989285 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:57:23.015846 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:57:23.042944 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:57:23.943120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:fbe3d0a9-344a-441e-9d0d-5a5cb4892b79&page=queryresults
[0m17:57:23.963685 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:d1070670-a844-411f-84f2-90b8f5812f7c&page=queryresults
[0m17:57:23.974757 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:8e7a2761-bec0-4691-bd50-afd91f457d3a&page=queryresults
[0m17:57:24.013518 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:047755f6-788c-48d2-ac13-8da3fe79f5c3&page=queryresults
[0m17:57:24.493896 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:57:22.913919 => 17:57:24.493896
[0m17:57:24.494898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386F28910>]}
[0m17:57:24.495894 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m17:57:24.495894 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:57:24.496893 [debug] [Thread-1 (]: Began running node model.turing_sales.stg_products
[0m17:57:24.496893 [info ] [Thread-1 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:57:24.497897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.stg_products)
[0m17:57:24.499010 [debug] [Thread-1 (]: Began compiling node model.turing_sales.stg_products
[0m17:57:24.501008 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:57:24.502513 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (compile): 17:57:24.499010 => 17:57:24.502513
[0m17:57:24.503522 [debug] [Thread-1 (]: Began executing node model.turing_sales.stg_products
[0m17:57:24.506518 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:57:24.506518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:24.509032 [debug] [Thread-1 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:57:24.539128 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:57:22.950589 => 17:57:24.539128
[0m17:57:24.540126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386EB54E0>]}
[0m17:57:24.541130 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m17:57:24.542636 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:57:24.549162 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:57:22.955622 => 17:57:24.549162
[0m17:57:24.550159 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019387F33B50>]}
[0m17:57:24.551162 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m17:57:24.551162 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:57:24.566675 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:57:22.945080 => 17:57:24.566675
[0m17:57:24.568181 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C99C90>]}
[0m17:57:24.568181 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m17:57:24.569726 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:57:24.570733 [debug] [Thread-3 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:57:24.570733 [info ] [Thread-3 (]: 6 of 6 START sql table model turing_dbt_sales_dev.fct_customer_orders .......... [RUN]
[0m17:57:24.571735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_customers, now model.turing_sales.fct_customer_orders)
[0m17:57:24.571735 [debug] [Thread-3 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m17:57:24.577246 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m17:57:24.578247 [debug] [Thread-3 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 17:57:24.572732 => 17:57:24.578247
[0m17:57:24.578247 [debug] [Thread-3 (]: Began executing node model.turing_sales.fct_customer_orders
[0m17:57:24.596864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:25.307223 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m17:57:25.308735 [debug] [Thread-3 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
      
    
    

    OPTIONS()
    as (
      with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.customer_id,
        orders.order_id,
        customer_addresses.address_id,
        orders.order_date_id,
        orders.ship_date_id,
        orders.line_total_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final
    );
  
[0m17:57:25.503800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:c19df28b-1031-4a1e-8e64-b69ee56d236b&page=queryresults
[0m17:57:26.012566 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:230962c1-cad2-4dec-a74b-ec9054cf996d&page=queryresults
[0m17:57:26.130977 [debug] [Thread-1 (]: Timing info for model.turing_sales.stg_products (execute): 17:57:24.503522 => 17:57:26.130977
[0m17:57:26.132537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C99B40>]}
[0m17:57:26.133493 [info ] [Thread-1 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m17:57:26.134491 [debug] [Thread-1 (]: Finished running node model.turing_sales.stg_products
[0m17:57:26.550084 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name order_date_id not found inside orders at [36:16]')
[0m17:57:27.327058 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b9d1fe19-95c9-4d1c-a2cd-815d6213c0f7&page=queryresults
[0m17:57:27.863716 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b9d1fe19-95c9-4d1c-a2cd-815d6213c0f7&page=queryresults
[0m17:57:27.864717 [debug] [Thread-3 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 17:57:24.579320 => 17:57:27.864717
[0m17:57:27.869235 [debug] [Thread-3 (]: Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Name order_date_id not found inside orders at [36:16]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m17:57:27.869235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47e9236-0be3-4f6d-ae16-9bed21aa994b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C99C90>]}
[0m17:57:27.870233 [error] [Thread-3 (]: 6 of 6 ERROR creating sql table model turing_dbt_sales_dev.fct_customer_orders . [[31mERROR[0m in 3.30s]
[0m17:57:27.871231 [debug] [Thread-3 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:57:27.872740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:27.873749 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:57:27.873749 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:57:27.874750 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:57:27.874750 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:57:27.874750 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m17:57:27.875748 [debug] [MainThread]: Connection 'model.turing_sales.stg_orders' was properly closed.
[0m17:57:27.875748 [info ] [MainThread]: 
[0m17:57:27.876750 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m17:57:27.878256 [debug] [MainThread]: Command end result
[0m17:57:27.888293 [info ] [MainThread]: 
[0m17:57:27.889305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:27.890302 [info ] [MainThread]: 
[0m17:57:27.890302 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\core\fct_customer_orders.sql)
  Name order_date_id not found inside orders at [36:16]
  compiled Code at target\run\turing_sales\models\marts\core\fct_customer_orders.sql
[0m17:57:27.891305 [info ] [MainThread]: 
[0m17:57:27.891305 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:57:27.892811 [debug] [MainThread]: Command `dbt run` failed at 17:57:27.892811 after 7.49 seconds
[0m17:57:27.893821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019382F3B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386C7DBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019386A49A50>]}
[0m17:57:27.894821 [debug] [MainThread]: Flushing usage events
[0m17:58:10.627895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7429B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA771010F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA77103130>]}


============================== 17:58:10.631065 | 4f551951-f041-4ea0-ad11-67d1a2f4b9e2 ==============================
[0m17:58:10.631065 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:58:10.632576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5\\logs', 'profiles_dir': 'E:\\Documents\\DE course\\M3_S2\\jukaral-DE3.2.5', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:58:11.220127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA770B3E20>]}
[0m17:58:11.307891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA766687C0>]}
[0m17:58:11.309404 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:58:11.316923 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:58:11.400466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:11.401466 [debug] [MainThread]: Partial parsing: updated file: turing_sales://models\marts\core\fct_customer_orders.sql
[0m17:58:11.534635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA78185600>]}
[0m17:58:11.543660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA77FFA290>]}
[0m17:58:11.543660 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:58:11.544660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA77FFA260>]}
[0m17:58:11.545659 [info ] [MainThread]: 
[0m17:58:11.546660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:58:11.549173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project'
[0m17:58:11.550172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:12.351117 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_turing-job-ad-project_turing_dbt_sales_dev'
[0m17:58:12.352626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:13.235540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA77FF8C70>]}
[0m17:58:13.235540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:58:13.236543 [info ] [MainThread]: 
[0m17:58:13.240068 [debug] [Thread-1 (]: Began running node model.turing_sales.dim_dates
[0m17:58:13.241063 [debug] [Thread-2 (]: Began running node model.turing_sales.stg_customer_addresses
[0m17:58:13.241063 [debug] [Thread-3 (]: Began running node model.turing_sales.stg_customers
[0m17:58:13.242568 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_orders
[0m17:58:13.242568 [info ] [Thread-1 (]: 1 of 6 START sql view model turing_dbt_sales_dev.dim_dates ..................... [RUN]
[0m17:58:13.243577 [info ] [Thread-2 (]: 2 of 6 START sql view model turing_dbt_sales_dev.stg_customer_addresses ........ [RUN]
[0m17:58:13.244578 [info ] [Thread-3 (]: 3 of 6 START sql view model turing_dbt_sales_dev.stg_customers ................. [RUN]
[0m17:58:13.245575 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.turing_sales.dim_dates'
[0m17:58:13.246579 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customer_addresses'
[0m17:58:13.244578 [info ] [Thread-4 (]: 4 of 6 START sql view model turing_dbt_sales_dev.stg_orders .................... [RUN]
[0m17:58:13.248085 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.turing_sales.stg_customers'
[0m17:58:13.248085 [debug] [Thread-1 (]: Began compiling node model.turing_sales.dim_dates
[0m17:58:13.249092 [debug] [Thread-2 (]: Began compiling node model.turing_sales.stg_customer_addresses
[0m17:58:13.250096 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.turing_sales.stg_orders'
[0m17:58:13.250096 [debug] [Thread-3 (]: Began compiling node model.turing_sales.stg_customers
[0m17:58:13.259116 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.dim_dates"
[0m17:58:13.262622 [debug] [Thread-2 (]: Writing injected SQL for node "model.turing_sales.stg_customer_addresses"
[0m17:58:13.262622 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_orders
[0m17:58:13.265637 [debug] [Thread-3 (]: Writing injected SQL for node "model.turing_sales.stg_customers"
[0m17:58:13.270150 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_orders"
[0m17:58:13.271149 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (compile): 17:58:13.251093 => 17:58:13.271149
[0m17:58:13.271149 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (compile): 17:58:13.260116 => 17:58:13.271149
[0m17:58:13.272738 [debug] [Thread-1 (]: Began executing node model.turing_sales.dim_dates
[0m17:58:13.273664 [debug] [Thread-2 (]: Began executing node model.turing_sales.stg_customer_addresses
[0m17:58:13.273664 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (compile): 17:58:13.263630 => 17:58:13.273664
[0m17:58:13.287906 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (compile): 17:58:13.266636 => 17:58:13.287906
[0m17:58:13.306297 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.dim_dates"
[0m17:58:13.309809 [debug] [Thread-2 (]: Writing runtime sql for node "model.turing_sales.stg_customer_addresses"
[0m17:58:13.310807 [debug] [Thread-3 (]: Began executing node model.turing_sales.stg_customers
[0m17:58:13.310807 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_orders
[0m17:58:13.316075 [debug] [Thread-3 (]: Writing runtime sql for node "model.turing_sales.stg_customers"
[0m17:58:13.319313 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_orders"
[0m17:58:13.320317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:13.321314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:58:13.321314 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:58:13.322823 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:58:13.323830 [debug] [Thread-1 (]: On model.turing_sales.dim_dates: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.dim_dates"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`dim_dates`
  OPTIONS()
  as with 

source_dates as (
    select distinct Order_Date as date_iso from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

dates as (
    select
        date_iso,
        extract(year from date_iso) as year,
        extract(month from date_iso) as month,
        extract(day from date_iso) as day
    from source_dates
)

select * from dates;


[0m17:58:13.326829 [debug] [Thread-2 (]: On model.turing_sales.stg_customer_addresses: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customer_addresses"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customer_addresses as (
    select
        row_number() over () as address_id,
        Customer_ID as customer_id,
        Country as country,
        City as city,
        State as state,
        Postal_Code as postal_code,
        Region as region
    from (
        select distinct
            Customer_ID,
            Country,
            City,
            State,
            Postal_Code,
            Region
        from source
    ) distinct_addresses
)

select * from customer_addresses;


[0m17:58:13.326829 [debug] [Thread-4 (]: On model.turing_sales.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_orders"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`
  OPTIONS()
  as with

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

orders as (

select distinct
    Order_ID as order_id,
    Order_Date as order_date,
    Ship_Date as ship_date,
    Ship_Mode as ship_mode,
    Customer_ID as customer_id,
    Sales as line_total_usd
from source

)

select * from orders;


[0m17:58:13.377844 [debug] [Thread-3 (]: On model.turing_sales.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_customers"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

customers as (

select distinct
    Customer_ID as customer_id,
    Customer_Name as customer_name,
    Segment as segment
from source

)

select * from customers;


[0m17:58:14.400053 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:b2b4962e-93da-4eed-9770-a65a66037b8e&page=queryresults
[0m17:58:14.419921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:29385c32-e615-4e0c-bbe7-cd94b88c288f&page=queryresults
[0m17:58:14.451871 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:78d9c43e-37bc-44ab-8997-4e9c7ac4be6a&page=queryresults
[0m17:58:14.476746 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:55dcb3db-1f23-4296-9b0c-e41bbce945bb&page=queryresults
[0m17:58:15.099162 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_orders (execute): 17:58:13.316075 => 17:58:15.098153
[0m17:58:15.099162 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA79293B80>]}
[0m17:58:15.100158 [info ] [Thread-4 (]: 4 of 6 OK created sql view model turing_dbt_sales_dev.stg_orders ............... [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m17:58:15.101164 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_orders
[0m17:58:15.101164 [debug] [Thread-4 (]: Began running node model.turing_sales.stg_products
[0m17:58:15.101164 [info ] [Thread-4 (]: 5 of 6 START sql view model turing_dbt_sales_dev.stg_products .................. [RUN]
[0m17:58:15.102672 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.turing_sales.stg_orders, now model.turing_sales.stg_products)
[0m17:58:15.103715 [debug] [Thread-4 (]: Began compiling node model.turing_sales.stg_products
[0m17:58:15.106723 [debug] [Thread-4 (]: Writing injected SQL for node "model.turing_sales.stg_products"
[0m17:58:15.107723 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (compile): 17:58:15.103715 => 17:58:15.107723
[0m17:58:15.107723 [debug] [Thread-4 (]: Began executing node model.turing_sales.stg_products
[0m17:58:15.111756 [debug] [Thread-4 (]: Writing runtime sql for node "model.turing_sales.stg_products"
[0m17:58:15.112754 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:58:15.114828 [debug] [Thread-4 (]: On model.turing_sales.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.stg_products"} */


  create or replace view `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_products`
  OPTIONS()
  as with 

source as (
    select * from `turing-job-ad-project`.`turing_dbt_sales`.`superstore_final_dataset`
),

products as (

select distinct
    Product_ID as product_id,
    Category as category,
    Sub_Category as sub_category,
    Product_Name as product_name
from source

)

select * from products;


[0m17:58:15.162864 [debug] [Thread-1 (]: Timing info for model.turing_sales.dim_dates (execute): 17:58:13.273664 => 17:58:15.162864
[0m17:58:15.165871 [debug] [Thread-3 (]: Timing info for model.turing_sales.stg_customers (execute): 17:58:13.311812 => 17:58:15.164872
[0m17:58:15.168387 [debug] [Thread-2 (]: Timing info for model.turing_sales.stg_customer_addresses (execute): 17:58:13.306297 => 17:58:15.167875
[0m17:58:15.169392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7821B700>]}
[0m17:58:15.169392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA78241FF0>]}
[0m17:58:15.170394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA78232080>]}
[0m17:58:15.171393 [info ] [Thread-1 (]: 1 of 6 OK created sql view model turing_dbt_sales_dev.dim_dates ................ [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m17:58:15.172905 [debug] [Thread-1 (]: Finished running node model.turing_sales.dim_dates
[0m17:58:15.171393 [info ] [Thread-3 (]: 3 of 6 OK created sql view model turing_dbt_sales_dev.stg_customers ............ [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m17:58:15.173918 [debug] [Thread-3 (]: Finished running node model.turing_sales.stg_customers
[0m17:58:15.172905 [info ] [Thread-2 (]: 2 of 6 OK created sql view model turing_dbt_sales_dev.stg_customer_addresses ... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m17:58:15.174914 [debug] [Thread-2 (]: Finished running node model.turing_sales.stg_customer_addresses
[0m17:58:15.175917 [debug] [Thread-1 (]: Began running node model.turing_sales.fct_customer_orders
[0m17:58:15.176914 [info ] [Thread-1 (]: 6 of 6 START sql table model turing_dbt_sales_dev.fct_customer_orders .......... [RUN]
[0m17:58:15.177912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.turing_sales.dim_dates, now model.turing_sales.fct_customer_orders)
[0m17:58:15.177912 [debug] [Thread-1 (]: Began compiling node model.turing_sales.fct_customer_orders
[0m17:58:15.182934 [debug] [Thread-1 (]: Writing injected SQL for node "model.turing_sales.fct_customer_orders"
[0m17:58:15.183940 [debug] [Thread-1 (]: Timing info for model.turing_sales.fct_customer_orders (compile): 17:58:15.178421 => 17:58:15.183940
[0m17:58:15.184941 [debug] [Thread-1 (]: Began executing node model.turing_sales.fct_customer_orders
[0m17:58:15.204720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:15.923581 [debug] [Thread-1 (]: Writing runtime sql for node "model.turing_sales.fct_customer_orders"
[0m17:58:15.924582 [debug] [Thread-1 (]: On model.turing_sales.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dev-bigquery", "target_name": "dev", "node_id": "model.turing_sales.fct_customer_orders"} */

  
    

    create or replace table `turing-job-ad-project`.`turing_dbt_sales_dev`.`fct_customer_orders`
      
    
    

    OPTIONS()
    as (
      with customers as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customers`

),

orders as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_orders`

),

customer_addresses as (

    select * from `turing-job-ad-project`.`turing_dbt_sales_dev`.`stg_customer_addresses`

),

final as (
    select
        customers.customer_id,
        orders.order_id,
        customer_addresses.address_id,
        orders.order_date as order_date_id,
        orders.ship_date as ship_date_id,
        orders.line_total_usd
    from orders

    join customers
    on orders.Customer_ID = customers.Customer_ID

    join customer_addresses
    on orders.Customer_ID = customer_addresses.Customer_ID
)

select * from final
    );
  
[0m17:58:16.132901 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:fddd1938-7c05-4365-9a90-5c5f2d918dd9&page=queryresults
[0m17:58:16.700553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=turing-job-ad-project&j=bq:US:f0d1db29-bebf-4d36-a48c-31ad4b5e83f1&page=queryresults
[0m17:58:16.810126 [debug] [Thread-4 (]: Timing info for model.turing_sales.stg_products (execute): 17:58:15.108756 => 17:58:16.810126
[0m17:58:16.811127 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA78186920>]}
[0m17:58:16.811127 [info ] [Thread-4 (]: 5 of 6 OK created sql view model turing_dbt_sales_dev.stg_products ............. [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m17:58:16.812633 [debug] [Thread-4 (]: Finished running node model.turing_sales.stg_products
[0m17:58:20.518048 [debug] [Thread-1 (]: Timing info for model.turing_sales.fct_customer_orders (execute): 17:58:15.184941 => 17:58:20.518048
[0m17:58:20.519054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f551951-f041-4ea0-ad11-67d1a2f4b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA782641F0>]}
[0m17:58:20.520056 [info ] [Thread-1 (]: 6 of 6 OK created sql table model turing_dbt_sales_dev.fct_customer_orders ..... [[32mCREATE TABLE (69.4k rows, 1.3 MiB processed)[0m in 5.34s]
[0m17:58:20.521060 [debug] [Thread-1 (]: Finished running node model.turing_sales.fct_customer_orders
[0m17:58:20.522569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:20.522569 [debug] [MainThread]: Connection 'list_turing-job-ad-project' was properly closed.
[0m17:58:20.523581 [debug] [MainThread]: Connection 'list_turing-job-ad-project_turing_dbt_sales_dev' was properly closed.
[0m17:58:20.523581 [debug] [MainThread]: Connection 'model.turing_sales.fct_customer_orders' was properly closed.
[0m17:58:20.523581 [debug] [MainThread]: Connection 'model.turing_sales.stg_customer_addresses' was properly closed.
[0m17:58:20.524581 [debug] [MainThread]: Connection 'model.turing_sales.stg_customers' was properly closed.
[0m17:58:20.524581 [debug] [MainThread]: Connection 'model.turing_sales.stg_products' was properly closed.
[0m17:58:20.524581 [info ] [MainThread]: 
[0m17:58:20.525583 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m17:58:20.526580 [debug] [MainThread]: Command end result
[0m17:58:20.535609 [info ] [MainThread]: 
[0m17:58:20.536609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:20.538117 [info ] [MainThread]: 
[0m17:58:20.538117 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:58:20.539125 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:20.539125 after 9.97 seconds
[0m17:58:20.540125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7429B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA79314B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA77D15030>]}
[0m17:58:20.540125 [debug] [MainThread]: Flushing usage events
